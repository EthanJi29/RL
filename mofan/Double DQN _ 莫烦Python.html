<!DOCTYPE html>
<!-- saved from url=(0080)https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN -->
<html lang="zh"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="title" content="Double DQN | 莫烦Python"><meta name="description" content="接下来我们说说为什么会有 Double DQN 这种算法. 所以我们从 Double DQN 相对于 Natural DQN (传统 DQN) 的优势说起. 一句话概括, DQN 基于 Q-learning, Q-Learning 中有 Qmax, Qmax 会导致 Q现实 当中的过估计 (overestimate). 而 Double DQN 就是用来解决过估计的. 在实际问题中, 如果你输出你的 DQN 的 Q 值, 可能就会发现, Q 值都超级大. 这就是出现了 overestimate."><meta name="image" content="https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.5_DDQN.jpg"><meta name="keywords" content="莫烦,沫凡,周沫凡,周莫烦,周莫凡,python,tutorial,machine learning,Double DQN"><meta name="author" content="Mofan,Morvan,莫烦,周沫凡,周莫烦"><meta name="baidu-site-verification" content="qdybaXHfFg"><meta name="sogou_site_verification" content="zzqZtIRvnK"><meta name="msvalidate.01" content="A25A16143F8A52E0CC3FD76FE0E5F03B"><meta name="360-site-verification" content="2ab9df6f0a067733338a68c01294e730"><title>Double DQN | 莫烦Python</title><meta property="fb:app_id" content="2053270218284962"><meta property="og:site_name" content="莫烦Python"><meta property="og:title" content="Double DQN | 莫烦Python"><meta property="og:description" content="接下来我们说说为什么会有 Double DQN 这种算法. 所以我们从 Double DQN 相对于 Natural DQN (传统 DQN) 的优势说起. 一句话概括, DQN 基于 Q-learning, Q-Learning 中有 Qmax, Qmax 会导致 Q现实 当中的过估计 (overestimate). 而 Double DQN 就是用来解决过估计的. 在实际问题中, 如果你输出你的 DQN 的 Q 值, 可能就会发现, Q 值都超级大. 这就是出现了 overestimate."><meta property="og:image" content="https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.5_DDQN.jpg"><meta property="og:url" content="http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN"><meta property="og:type" content="article"><meta name="twitter:card" content="article"><meta name="twitter:site" content="http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN"><meta name="twitter:title" content="Double DQN | 莫烦Python"><meta name="twitter:description" content="接下来我们说说为什么会有 Double DQN 这种算法. 所以我们从 Double DQN 相对于 Natural DQN (传统 DQN) 的优势说起. 一句话概括, DQN 基于 Q-learning, Q-Learning 中有 Qmax, Qmax 会导致 Q现实 当中的过估计 (overestimate). 而 Double DQN 就是用来解决过估计的. 在实际问题中, 如果你输出你的 DQN 的 Q 值, 可能就会发现, Q 值都超级大. 这就是出现了 overestimate."><meta name="twitter:creator" content="莫烦Python"><meta name="twitter:image" content="https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.5_DDQN.jpg"><link href="./Double DQN _ 莫烦Python_files/page-style.min.css" type="text/css" rel="stylesheet"><script type="text/javascript" async="" src="./Double DQN _ 莫烦Python_files/analytics.js"></script><script type="text/javascript" async="" src="./Double DQN _ 莫烦Python_files/js"></script><script src="./Double DQN _ 莫烦Python_files/f(5).txt"></script><script src="./Double DQN _ 莫烦Python_files/f(6).txt" id="google_shimpl"></script><script src="./Double DQN _ 莫烦Python_files/hm.js"></script><script src="./Double DQN _ 莫烦Python_files/jquery-1.9.1.min.js"></script><script src="./Double DQN _ 莫烦Python_files/comment.min.js"></script><link rel="stylesheet" href="./Double DQN _ 莫烦Python_files/gml.min.css"><script src="./Double DQN _ 莫烦Python_files/highlight-10.5.0.min.js"></script><script type="text/javascript">hljs.initHighlightingOnLoad();</script><script type="text/javascript">
    
    $(window).bind('scroll load', function () {
      $.each($('.lazy-img'), function () {
        if ($(this).attr('data-src') &&
          $(this).offset().top < ($(window).scrollTop() + $(window).height() + 3000)) {
          var source = $(this).data('src');
          $(this).attr('src', source);
          $(this).removeAttr('data-src');
        }
      })
    })
  </script><script src="./Double DQN _ 莫烦Python_files/codemirror.min.js"></script><link rel="stylesheet" href="./Double DQN _ 莫烦Python_files/codemirror.min.css"><link rel="stylesheet" href="./Double DQN _ 莫烦Python_files/darcula.min.css"><link rel="stylesheet" href="./Double DQN _ 莫烦Python_files/foldgutter.min.css"><link rel="stylesheet" href="./Double DQN _ 莫烦Python_files/show-hint.min.css"><script src="./Double DQN _ 莫烦Python_files/show-hint.min.js"></script><script src="./Double DQN _ 莫烦Python_files/python-hint.min.js"></script><script src="./Double DQN _ 莫烦Python_files/anyword-hint.min.js"></script><script src="./Double DQN _ 莫烦Python_files/python.min.js"></script><script src="./Double DQN _ 莫烦Python_files/sublime.min.js"></script><script src="./Double DQN _ 莫烦Python_files/active-line.min.js"></script><script src="./Double DQN _ 莫烦Python_files/foldcode.min.js"></script><script src="./Double DQN _ 莫烦Python_files/foldgutter.min.js"></script><script src="./Double DQN _ 莫烦Python_files/indent-fold.min.js"></script><script src="./Double DQN _ 莫烦Python_files/brace-fold.min.js"></script><script src="./Double DQN _ 莫烦Python_files/comment-fold.min.js"></script><script src="./Double DQN _ 莫烦Python_files/matchbrackets.min.js"></script><script src="./Double DQN _ 莫烦Python_files/closebrackets.min.js"></script><script src="./Double DQN _ 莫烦Python_files/comment.min(1).js"></script><script src="./Double DQN _ 莫烦Python_files/code.min.js"></script><link rel="stylesheet" href="./Double DQN _ 莫烦Python_files/myCodeMirror.min.css"><script src="./Double DQN _ 莫烦Python_files/pyodide.min.js"></script><script type="text/javascript">
  let dependencies, preCode;
  let onInteractivePage = false;
  let pyodideFullUrl = "";
  
  $(document).ready(function () {
    setCodeArea(onInteractivePage, dependencies, preCode, pyodideFullUrl)
  });
</script><meta http-equiv="origin-trial" content="A7CQXglZzTrThjGTBEn1rWTxHOEtkWivwzgea+NjyardrwlieSjVuyG44PkYgIPGs8Q9svD8sF3Yedn0BBBjXAkAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A3vKT9yxRPjmXN3DpIiz58f5JykcWHjUo/W7hvmtjgh9jPpQgem9VbADiNovG8NkO6mRmk70Kex8/KUqAYWVWAEAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A4A26Ymj79UVY7C7JGUS4BG1s7MdcDokAQf/RP0paks+RoTYbXHxceT/5L4iKcsleFCngi75YfNRGW2+SpVv1ggAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="As0hBNJ8h++fNYlkq8cTye2qDLyom8NddByiVytXGGD0YVE+2CEuTCpqXMDxdhOMILKoaiaYifwEvCRlJ/9GcQ8AAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="AgRYsXo24ypxC89CJanC+JgEmraCCBebKl8ZmG7Tj5oJNx0cmH0NtNRZs3NB5ubhpbX/bIt7l2zJOSyO64NGmwMAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A7CQXglZzTrThjGTBEn1rWTxHOEtkWivwzgea+NjyardrwlieSjVuyG44PkYgIPGs8Q9svD8sF3Yedn0BBBjXAkAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A3vKT9yxRPjmXN3DpIiz58f5JykcWHjUo/W7hvmtjgh9jPpQgem9VbADiNovG8NkO6mRmk70Kex8/KUqAYWVWAEAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A4A26Ymj79UVY7C7JGUS4BG1s7MdcDokAQf/RP0paks+RoTYbXHxceT/5L4iKcsleFCngi75YfNRGW2+SpVv1ggAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="As0hBNJ8h++fNYlkq8cTye2qDLyom8NddByiVytXGGD0YVE+2CEuTCpqXMDxdhOMILKoaiaYifwEvCRlJ/9GcQ8AAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="AgRYsXo24ypxC89CJanC+JgEmraCCBebKl8ZmG7Tj5oJNx0cmH0NtNRZs3NB5ubhpbX/bIt7l2zJOSyO64NGmwMAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A7CQXglZzTrThjGTBEn1rWTxHOEtkWivwzgea+NjyardrwlieSjVuyG44PkYgIPGs8Q9svD8sF3Yedn0BBBjXAkAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A3vKT9yxRPjmXN3DpIiz58f5JykcWHjUo/W7hvmtjgh9jPpQgem9VbADiNovG8NkO6mRmk70Kex8/KUqAYWVWAEAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A4A26Ymj79UVY7C7JGUS4BG1s7MdcDokAQf/RP0paks+RoTYbXHxceT/5L4iKcsleFCngi75YfNRGW2+SpVv1ggAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="As0hBNJ8h++fNYlkq8cTye2qDLyom8NddByiVytXGGD0YVE+2CEuTCpqXMDxdhOMILKoaiaYifwEvCRlJ/9GcQ8AAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="AgRYsXo24ypxC89CJanC+JgEmraCCBebKl8ZmG7Tj5oJNx0cmH0NtNRZs3NB5ubhpbX/bIt7l2zJOSyO64NGmwMAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A7CQXglZzTrThjGTBEn1rWTxHOEtkWivwzgea+NjyardrwlieSjVuyG44PkYgIPGs8Q9svD8sF3Yedn0BBBjXAkAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A3vKT9yxRPjmXN3DpIiz58f5JykcWHjUo/W7hvmtjgh9jPpQgem9VbADiNovG8NkO6mRmk70Kex8/KUqAYWVWAEAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A4A26Ymj79UVY7C7JGUS4BG1s7MdcDokAQf/RP0paks+RoTYbXHxceT/5L4iKcsleFCngi75YfNRGW2+SpVv1ggAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="As0hBNJ8h++fNYlkq8cTye2qDLyom8NddByiVytXGGD0YVE+2CEuTCpqXMDxdhOMILKoaiaYifwEvCRlJ/9GcQ8AAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="AgRYsXo24ypxC89CJanC+JgEmraCCBebKl8ZmG7Tj5oJNx0cmH0NtNRZs3NB5ubhpbX/bIt7l2zJOSyO64NGmwMAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="></head>                        <body class="vsc-initialized"> <a href="./Double DQN _ 莫烦Python_files/4.5_DDQN.jpg"><img alt="Double DQN" src="./Double DQN _ 莫烦Python_files/4.5_DDQN.jpg" style="display: none"></a> <header> <nav id="home-nav"> <ul> <li id="liHome"><a class="nav-home bold" href="https://mofanpy.com/">莫烦PYTHON</a></li> <li id="liStudy" class="dropbtn"><a class="navClicker">学习 ▾</a> <ul class="dropdown-content" style="display: none"> <li class="dropbtn"> <a class="" href="https://mofanpy.com/learning-steps/"> <img class="icon-image" src="./Double DQN _ 莫烦Python_files/learning-steps.png" alt="推荐学习顺序">推荐学习顺序</a> </li> <li class="dropbtn"> <a class="navClicker" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN"> <img class="icon-image" src="./Double DQN _ 莫烦Python_files/python_icon.png" alt="Python基础 ▾">Python基础 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/basic_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="交互式学Python"> <a href="https://mofanpy.com/tutorials/python-basic/interactive-python/">交互式学Python </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/multiprocessing_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="多进程 multiprocessing"> <a href="https://mofanpy.com/tutorials/python-basic/multiprocessing/">多进程 multiprocessing </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/thread_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="多线程 threading"> <a href="https://mofanpy.com/tutorials/python-basic/threading/">多线程 threading </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/GUI_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="窗口视窗 Tkinter"> <a href="https://mofanpy.com/tutorials/python-basic/tkinter/">窗口视窗 Tkinter </a></li> </ul> </li> <li class="dropbtn"> <a class="navClicker" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN"> <img class="icon-image" src="./Double DQN _ 莫烦Python_files/ML_icon.png" alt="机器学习 ▾">机器学习 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/ML_intro_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="有趣的机器学习"> <a href="https://mofanpy.com/tutorials/machine-learning/ML-intro/">有趣的机器学习 </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/rl_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="强化学习 Reinforcement Learning"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/">强化学习 Reinforcement Learning </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/evolution_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="进化算法 Evolutionary Algorithm"> <a href="https://mofanpy.com/tutorials/machine-learning/evolutionary-algorithm/">进化算法 Evolutionary Algorithm </a></li> <li class="dropbtn"><img class="icon-image" src="./Double DQN _ 莫烦Python_files/neural_net_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="神经网络 ▾"> <a class="navClicker">神经网络 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/tf_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="Tensorflow"> <a href="https://mofanpy.com/tutorials/machine-learning/tensorflow/">Tensorflow</a> </li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/torch_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="PyTorch"> <a href="https://mofanpy.com/tutorials/machine-learning/torch/">PyTorch</a> </li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/theano_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="Theano"> <a href="https://mofanpy.com/tutorials/machine-learning/theano/">Theano</a> </li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/keras_icon.jpg" style="max-width:1.5em; max-height:1.1em;" alt="Keras"> <a href="https://mofanpy.com/tutorials/machine-learning/keras/">Keras</a> </li> </ul> </li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/sklearn_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="通用机器学习 Scikit-learn"> <a href="https://mofanpy.com/tutorials/machine-learning/sklearn/">通用机器学习 Scikit-learn </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/nlp_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="自然语言处理"> <a href="https://mofanpy.com/tutorials/machine-learning/nlp/">自然语言处理 </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/gan_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="生成对抗网络"> <a href="https://mofanpy.com/tutorials/machine-learning/gan/">生成对抗网络 </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/ML-practice_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="机器学习实战"> <a href="https://mofanpy.com/tutorials/machine-learning/ML-practice/">机器学习实战 </a></li> </ul> </li> <li class="dropbtn"> <a class="navClicker" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN"> <img class="icon-image" src="./Double DQN _ 莫烦Python_files/data_icon.png" alt="数据处理 ▾">数据处理 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/numpy.svg" style="max-width:1.5em; max-height:1.1em;" alt="Numpy 数据怪兽"> <a href="https://mofanpy.com/tutorials/data-manipulation/numpy/">Numpy 数据怪兽 </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/pandas.svg" style="max-width:1.5em; max-height:1.1em;" alt="Pandas 数据伙伴"> <a href="https://mofanpy.com/tutorials/data-manipulation/pandas/">Pandas 数据伙伴 </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/plt_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="画图 Matplotlib"> <a href="https://mofanpy.com/tutorials/data-manipulation/plt/">画图 Matplotlib </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/scraping_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="网页爬虫"> <a href="https://mofanpy.com/tutorials/data-manipulation/scraping/">网页爬虫 </a></li> </ul> </li> <li class="dropbtn"> <a class="navClicker" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN"> <img class="icon-image" src="./Double DQN _ 莫烦Python_files/others_icon.png" alt="提效工具 ▾">提效工具 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/git_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="Git 版本管理"> <a href="https://mofanpy.com/tutorials/others/git/">Git 版本管理 </a></li> <li><img class="icon-image" src="./Double DQN _ 莫烦Python_files/linux_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="Linux 简易教学"> <a href="https://mofanpy.com/tutorials/others/linux-basic/">Linux 简易教学 </a></li> </ul> </li> <li class="dropbtn"> <a class="" href="https://mofanpy.com/minipy/"> <img class="icon-image" src="./Double DQN _ 莫烦Python_files/minipy_icon.svg" alt="MiniPy 小程序">MiniPy 小程序</a> </li> <li class="dropbtn"> <a class="" href="https://mofanpy.com/rethink/"> <img class="icon-image" src="./Double DQN _ 莫烦Python_files/rethink.png" alt="Rethink">Rethink</a> </li> </ul> </li> <li id="liDiscuss"><a href="https://mofanpy.com/discuss">大家说</a></li> <li id="liMinipy"><a href="https://mofanpy.com/minipy/">MiniPy</a></li> <li id="liAbout" class="mobile-hid"><a href="https://mofanpy.com/about">About</a></li> <li id="liSupport"><a href="https://mofanpy.com/support">赞助</a></li> <li id="liSearch" class="mobile-hid"> <a class="search-bar navClicker"><img class="search-img" src="./Double DQN _ 莫烦Python_files/search_icon.png" alt="Go"></a> <form class="search-box dropdown-content" method="get" action="https://www.baidu.com/s" target="_blank"> <input type="hidden" name="q6" value="mofanpy.com"> <input type="hidden" name="tn" value="baiduadv"> <input class="search-text" type="text" name="q3" placeholder="Search.." size="20" value=""> </form> </li> <li id="liNotification" class="nav-notification nav-float-right"> <a id="nav-img-a" href="https://mofanpy.com/login">登录</a></li> </ul> </nav> <script type="text/javascript" async="">
    $(document).ready(function () {
      $('.navClicker').on("click", function (e) {
        $(this).next('.dropdown-content').toggle();
        e.stopPropagation();
        e.preventDefault();
      });
    });

    if ('False' === "True") {
      const aLink = $("#liNotification").children().first();
      aLink.empty();
      aLink.attr("id", "nav-img-a");
      aLink.attr("href", "/user/");
      aLink.append($("<img>", {
        id: "nav-img",
          src: "/static/img/icon/default_user_icon.png",
          alt: ""
      }));

      let navNoti = $(".nav-notification");
      navNoti.css({display: "inline-block"}).append(aLink);
      navNoti.html(navNoti.html());
      checkCommentResponse('https://mofanpy.com/api/comment');
    }

    function isOnMobile() {
      let check = false;
      (function (a) {
        if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true;
      })(navigator.userAgent || navigator.vendor || window.opera);
      if (navigator.userAgentData) {
        if (navigator.userAgentData.mobile) {
          check = true;
        }
      }
      return check;
    }


  </script> </header> <main class="tut-main"> <div id="left-side-share-donate"> <ul> <li> <a href="https://www.facebook.com/sharer/sharer.php?u=http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN&amp;pic=https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.5_DDQN.jpg" target="_blank"> <svg class="left-share-link" viewBox="0 0 1024 1024"> <path d="M1024,512C1024,229.23016,794.76978,0,512,0S0,229.23016,0,512c0,255.554,187.231,467.37012,432,505.77777V660H302V512H432V399.2C432,270.87982,508.43854,200,625.38922,200,681.40765,200,740,210,740,210V336H675.43713C611.83508,336,592,375.46667,592,415.95728V512H734L711.3,660H592v357.77777C836.769,979.37012,1024,767.554,1024,512Z" fill-rule="evenodd"></path> </svg> </a> </li> <li> <a href="https://service.weibo.com/share/share.php?url=http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN&amp;type=icon&amp;language=zh_cn&amp;searchPic=true&amp;title=Double%20DQN&amp;pic=https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.5_DDQN.jpg" target="_blank"> <svg class="left-share-link" viewBox="0 0 97.75 97.75"> <path d="M48.875,0C21.883,0,0,21.883,0,48.875S21.883,97.75,48.875,97.75S97.75,75.867,97.75,48.875S75.867,0,48.875,0z
                 M43.332,76.779c-14.294,0-28.904-6.928-28.904-18.32c0-5.957,3.773-12.844,10.271-19.344c8.68-8.674,18.799-12.627,22.604-8.818
                c1.679,1.678,1.841,4.582,0.763,8.051c-0.563,1.748,1.639,0.779,1.639,0.783c7.016-2.938,13.135-3.109,15.37,0.086
                c1.192,1.703,1.079,4.09-0.021,6.859c-0.509,1.273,0.157,1.473,1.127,1.762c3.952,1.227,8.351,4.189,8.351,9.412
                C74.531,65.893,62.068,76.779,43.332,76.779z M69.206,40.553c0.463-1.428,0.172-3.055-0.905-4.25
                c-1.076-1.191-2.668-1.645-4.136-1.334v-0.002c-1.224,0.266-2.431-0.52-2.69-1.742c-0.266-1.229,0.518-2.436,1.744-2.697
                c3.002-0.637,6.254,0.291,8.455,2.732c2.208,2.443,2.797,5.771,1.854,8.689c-0.385,1.195-1.664,1.846-2.857,1.465
                c-1.193-0.389-1.846-1.67-1.461-2.861H69.206z M82.438,44.828c0,0.002,0,0.008,0,0.01c-0.449,1.383-1.937,2.141-3.321,1.693
                c-1.39-0.447-2.148-1.932-1.699-3.32l-0.001-0.004c1.377-4.26,0.504-9.119-2.71-12.682c-3.218-3.563-7.96-4.926-12.343-3.994
                c-1.426,0.305-2.826-0.605-3.131-2.029s0.604-2.826,2.029-3.131h0.002c6.16-1.309,12.834,0.602,17.357,5.619
                C83.148,32,84.37,38.832,82.438,44.828z"></path> <path d="M43.444,57.424c-0.678-0.27-1.526,0.057-1.924,0.723c-0.386,0.672-0.173,1.435,0.507,1.713
                c0.69,0.285,1.573-0.043,1.972-0.727C44.38,58.447,44.133,57.676,43.444,57.424z"></path> <path d="M40.688,45.58c-11.402,1.129-20.051,8.111-19.311,15.598c0.741,7.488,10.588,12.643,21.991,11.518
                c11.405-1.127,20.05-8.11,19.312-15.602C61.939,49.607,52.096,44.451,40.688,45.58z M50.695,63.24
                c-2.327,5.264-9.021,8.07-14.702,6.24c-5.482-1.771-7.803-7.187-5.402-12.063c2.356-4.783,8.492-7.487,13.918-6.074
                C50.126,52.795,52.992,58.094,50.695,63.24z"></path> <path d="M39.091,59.229c-1.767-0.739-4.049,0.021-5.138,1.73c-1.104,1.715-0.587,3.76,1.167,4.559
                c1.779,0.813,4.141,0.041,5.244-1.719C41.448,62.02,40.876,59.99,39.091,59.229z"></path> </svg> </a> </li> <li> <a href="https://static.mofanpy.com/static/qr/tutorials/machine-learning/reinforcement-learning/double_DQN_deploy.png" target="_blank"> <svg class="left-share-link" viewBox="0 0 24 24"> <path d="M12 0c-6.626 0-12 5.372-12 12 0 6.627 5.374 12 12 12 6.627 0 12-5.373 12-12 0-6.628-5.373-12-12-12zm5.543 16.389c.889-.644 1.457-1.597 1.457-2.656 0-1.94-1.888-3.514-4.217-3.514-2.329 0-4.217 1.574-4.217 3.514 0 1.941 1.888 3.514 4.217 3.514.481 0 .946-.068 1.377-.192l.124-.019c.081 0 .154.025.224.065l.923.533.081.026c.078 0 .14-.063.14-.14l-.022-.103-.19-.709-.015-.09c0-.094.047-.178.118-.229zm-7.483-10.049c-2.794 0-5.06 1.888-5.06 4.217 0 1.27.682 2.414 1.748 3.187.086.061.142.161.142.275l-.018.107-.228.851-.027.123c0 .093.076.169.169.169l.097-.032 1.108-.639c.083-.048.172-.078.269-.078l.149.022c.516.149 1.074.231 1.651.231l.278-.006c-.11-.329-.17-.675-.17-1.034 0-2.123 2.066-3.845 4.615-3.845l.275.007c-.381-2.015-2.473-3.555-4.998-3.555zm3.317 6.831c-.31 0-.562-.252-.562-.562 0-.311.252-.562.562-.562.311 0 .563.251.563.562 0 .31-.252.562-.563.562zm2.812 0c-.311 0-.562-.252-.562-.562 0-.311.251-.562.562-.562.31 0 .562.251.562.562 0 .31-.252.562-.562.562zm-7.815-3.289c-.373 0-.675-.302-.675-.675 0-.372.302-.674.675-.674.372 0 .674.302.674.674 0 .373-.302.675-.674.675zm3.373 0c-.373 0-.675-.302-.675-.675 0-.372.302-.674.675-.674.373 0 .675.302.675.674 0 .373-.302.675-.675.675z" fill-rule="evenodd"></path> </svg> </a> </li> <li> <a href="https://twitter.com/intent/tweet?url=http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN&amp;original_referer=http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN" target="_blank"> <svg class="left-share-link" viewBox="0 0 24 24"> <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z" fill-rule="evenodd"></path> </svg> </a> </li> <li> <a id="left-donation" href="https://mofanpy.com/support"> <p class="left-donation-text">支持</p> <div> <img src="./Double DQN _ 莫烦Python_files/Wechat1.png"> <img src="./Double DQN _ 莫烦Python_files/alipay.png"> </div> </a> </li> </ul> </div> <div class="tut-post-main"> <div class="section ie-size"> <a href="https://mofanpy.com/tutorials/data-manipulation/pandas/"> <div class="marquee"><p>【新】在线运行 Pandas 学习数据管理</p></div> </a> <a href="https://mofanpy.com/tutorials/python-basic/interactive-python/"> <div class="marquee"><p>【浏览器跑Python】交互式Python学习</p></div> </a> <a href="https://mofanpy.com/minipy/"> <div class="marquee"><p>【MiniPy】分享你的 Python 小程序</p></div> </a> </div> <div class="section ie-size" id="top-a-d-s"> <script async="" src="./Double DQN _ 莫烦Python_files/f(7).txt" crossorigin="anonymous" data-checked-head="true"></script> <ins class="adsbygoogle" style="display:inline-block;width:700px;height:90px" data-ad-client="ca-pub-4601203457616636" data-ad-slot="6002797349" data-adsbygoogle-status="done" data-ad-status="filled"><div id="aswift_1_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 90px; width: 700px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;border:0;width:700px;height:90px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="700" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./Double DQN _ 莫烦Python_files/ads.html" data-google-container-id="a!2" data-google-query-id="CPaPjf6Hx4ADFYvRlgodhpcDOw" data-load-complete="true"></iframe></div></ins> </div> <div class="section ie-size"> <script src="./Double DQN _ 莫烦Python_files/video-select.min.js"></script> <div id="videogfw" class="video-container videogfw-bilibili"> <script type="text/javascript" async="">
      var bilibili_src = "//player.bilibili.com/player.html?aid=16921335&cid=27657254&page=19&high_quality=1&danmaku=0&as_wide=1";
      var youtube_src = "//www.youtube.com/embed/TjAEpfE8A64";
      const youku_src = "//player.youku.com/embed/XMjYxMTA1NzkwOA==";
      if (window.innerWidth > 800) {
        youtube_src += "?autoplay=1&mute=1";
        
      }
      getEmbeddedVideo(bilibili_src, "av16921335?p=19", youtube_src, "TjAEpfE8A64", youku_src, "XMjYxMTA1NzkwOA");

      if (!isOnMobile()) {
        moveVideo();
      }

    </script> <iframe id="myVideo" src="./Double DQN _ 莫烦Python_files/player.html" frameborder="0" scrolling="no" allow="autoplay" framespacing="0" allowfullscreen="" autoplay="autoplay" width="100%"></iframe></div> <div class="switch-video-div"> <span style="font-weight: bold;vertical-align: super;">切换视频源：</span> <button class="switch-video-btn" onclick="chooseVideo(youtube_src, &#39;youtube&#39;, &#39;TjAEpfE8A64&#39;)"> <img class="icon" src="./Double DQN _ 莫烦Python_files/youtube.png" alt="Youtube频道"> </button> <button class="switch-video-btn" onclick="chooseVideo(bilibili_src, &#39;bilibili&#39;, &#39;
        av16921335?p=19&#39;)"> <img class="icon" src="./Double DQN _ 莫烦Python_files/bilibili_icon.png" alt="Bilibili"> </button> <button class="switch-video-btn" onclick="chooseVideo(youku_src, &#39;youku&#39;, &#39;XMjYxMTA1NzkwOA&#39;)"> <img class="icon" src="./Double DQN _ 莫烦Python_files/youku.jpg" alt="优酷频道"> </button> <p id="video-alrt-info" style="display: block; font-size: 0.8em; text-align: center;">(无法播放? 请 <a href="https://www.bilibili.com/video/av16921335?p=19" target="_blank">点击这里</a> 跳转至B站内)</p> <hr style="width: 60%;"> </div> <div class="pad-page-navigation"> <div class="PageNavigation"> <a class="prev" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym"> <b>«</b> OpenAI gym 环境库</a> <a class="next" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/prioritized-replay"> Prioritized Experience Replay (DQN) <b>»</b></a> </div> </div> </div> <div class="section ie-size"> <div class="tut-main-content-pad"> <br> <p class="course-title">Double DQN</p> <div style="text-align: center;color: #646464; font-size: 15px;"> 作者: <span class="author"> 莫烦 </span> 编辑: <span class="editor"> 莫烦 </span> 发布于: <span class="publish-date"> 2017-03-07 </span> </div> <div class="section ie-size" id="under-title-a-d-s"> <script async="" src="./Double DQN _ 莫烦Python_files/f(7).txt" crossorigin="anonymous" data-checked-head="true"></script> <ins class="adsbygoogle" style="display:inline-block;width:250px;height:250px" data-ad-client="ca-pub-4601203457616636" data-ad-slot="2975922481" data-adsbygoogle-status="done" data-ad-status="filled"><div id="aswift_2_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 250px; width: 250px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;border:0;width:250px;height:250px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="250" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./Double DQN _ 莫烦Python_files/ads(1).html" data-google-container-id="a!3" data-google-query-id="CKjCj_6Hx4ADFVzAFgUdwOgFEg" data-load-complete="true"></iframe></div></ins> </div> <p>学习资料:</p> <ul> <li><a href="https://github.com/MorvanZhou/Reinforcement-learning-with-tensorflow/tree/master/contents/5.1_Double_DQN" target="_blank">全部代码</a></li> <li><a href="https://mofanpy.com/tutorials/machine-learning/ML-practice/RL-build-arm-from-scratch1">强化学习实战</a></li> <li>论文 <a href="https://arxiv.org/abs/1509.06461" target="_blank">Deep Reinforcement Learning with Double Q-learning</a></li> </ul> <h1 class="tut-h1-pad" id="要点">要点<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#%E8%A6%81%E7%82%B9" class="headerlink" title="Permalink to this headline">¶</a></h1> <p><strong>本篇教程是基于 Deep Q network (DQN) 的选学教程. 以下教程缩减了在 DQN 方面的介绍, 着重强调 Double DQN 和 DQN 在代码上不同的地方. 所以还没了解 DQN 的同学们, 有关于 DQN 的知识, 请从 <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-DQN">这个视频</a> 和 <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN1">这个Python教程</a> 开始学习.</strong></p> <p>接下来我们说说为什么会有 Double DQN 这种算法. 所以我们从 Double DQN 相对于 Natural DQN (传统 DQN) 的优势说起.</p> <p>一句话概括, DQN 基于 Q-learning, Q-Learning 中有 <code>Qmax</code>, <code>Qmax</code> 会导致 <code>Q现实</code> 当中的过估计 (overestimate). 而 Double DQN 就是用来解决过估计的. 在实际问题中, 如果你输出你的 DQN 的 Q 值, 可能就会发现, Q 值都超级大. 这就是出现了 overestimate.</p> <p>这次的 Double DQN 的算法基于的是 OpenAI Gym 中的 <code>Pendulum</code> 环境. 如果还不了解如何使用 OpenAI 的话, 这里有<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym">我的一个教程</a>. 以下就是这次的结果, 先睹为快.</p> <p><div class="vsc-controller"><template shadowrootmode="open">
        <style>
          @import "chrome-extension://nffaoalbilbmmfgbnbgppjihopabppdk/shadow.css";
        </style>

        <div id="controller" style="top:1935.6015625px; left:231.3984375px; opacity:0.3">
          <span data-action="drag" class="draggable">1.00</span>
          <span id="controls">
            <button data-action="rewind" class="rw">«</button>
            <button data-action="slower">−</button>
            <button data-action="faster">+</button>
            <button data-action="advance" class="rw">»</button>
            <button data-action="display" class="hideButton">×</button>
          </span>
        </div>
      </template></div><video class="tut-content-video" controls="" loop="" autoplay="" muted=""> <source src="https://static.mofanpy.com/static/results/reinforcement-learning/Pendulum%20DQN.mp4" type="video/mp4"> Your browser does not support HTML5 video. </video></p> <h1 class="tut-h1-pad" id="Double DQN 算法">Double DQN 算法<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#Double%20DQN%20%E7%AE%97%E6%B3%95" class="headerlink" title="Permalink to this headline">¶</a></h1> <p>我们知道 DQN 的神经网络部分可以看成一个 <code>最新的神经网络</code> + <code>老神经网络</code>, 他们有相同的结构, 但内部的参数更新却有时差. 而它的 <code>Q现实</code> 部分是这样的:</p> <p><a href="https://static.mofanpy.com/static/results/reinforcement-learning/4-5-1.png" target="_blank"><img class="course-image lazy-img" src="./Double DQN _ 莫烦Python_files/loading.gif" data-src="https://static.mofanpy.com/static/results/reinforcement-learning/4-5-1.png" alt="4-5-1.png" title="4-5-1.png"></a></p> <p>因为我们的神经网络预测 <code>Qmax</code> 本来就有误差, 每次也向着最大误差的 <code>Q现实</code> 改进神经网络, 就是因为这个 <code>Qmax</code> 导致了 overestimate. 所以 Double DQN 的想法就是引入另一个神经网络来打消一些最大误差的影响. 而 DQN 中本来就有两个神经网络, 我们何不利用一下这个地理优势呢. 所以, 我们用 <code>Q估计</code> 的神经网络估计 <code>Q现实</code> 中 <code>Qmax(s', a')</code> 的最大动作值. 然后用这个被 <code>Q估计</code> 估计出来的动作来选择 <code>Q现实</code> 中的 <code>Q(s')</code>. 总结一下:</p> <p>有两个神经网络: <code>Q_eval</code> (Q估计中的), <code>Q_next</code> (Q现实中的).</p> <p>原本的 <code>Q_next = max(Q_next(s', a_all))</code>.</p> <p>Double DQN 中的 <code>Q_next = Q_next(s', argmax(Q_eval(s', a_all)))</code>. 也可以表达成下面那样.</p> <p><a href="https://static.mofanpy.com/static/results/reinforcement-learning/4-5-2.png" target="_blank"><img class="course-image lazy-img" src="./Double DQN _ 莫烦Python_files/loading.gif" data-src="https://static.mofanpy.com/static/results/reinforcement-learning/4-5-2.png" alt="4-5-2.png" title="4-5-2.png"></a></p> <h1 class="tut-h1-pad" id="更新方法">更新方法<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#%E6%9B%B4%E6%96%B0%E6%96%B9%E6%B3%95" class="headerlink" title="Permalink to this headline">¶</a></h1> <p>好了, 有了理论, 我们就来用 Python 实现它吧.</p> <p>这里的代码都是基于之前 DQN 教程中的代码 <a href="https://github.com/MorvanZhou/Reinforcement-learning-with-tensorflow/blob/master/contents/5.1_Double_DQN/RL_brain.py" target="_blank">(github)</a>, 在 <code>RL_brain</code> 中, 我们将 class 的名字改成 <code>DoubleDQN</code>, 为了对比 Natural DQN, 我们也保留原来大部分的 DQN 的代码. 我们在 <code>__init__</code> 中加一个 <code>double_q</code> 参数来表示使用的是 Natural DQN 还是 Double DQN. 为了对比的需要, 我们的 <code>tf.Session()</code> 也单独传入. 并移除原本在 DQN 代码中的这一句:</p> <p><code>self.sess.run(tf.global_variables_initializer())</code></p> <div><textarea class="scriptInput" style="display: none;">class DoubleDQN:
    def __init__(..., double_q=True, sess=None):
        ...
        self.double_q = double_q
        if sess is None:
            self.sess = tf.Session()
            self.sess.run(tf.global_variables_initializer())
        else:
            self.sess = sess
        ...
</textarea><div class="CodeMirror cm-s-darcula" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; min-height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: -15px; border-right-width: 35px; min-height: 217px; min-width: 505.461px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">DoubleDQN</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">def</span> <span class="cm-def">__init__</span>(<span class="cm-operator">...</span>, <span class="cm-variable">double_q</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>, <span class="cm-variable">sess</span><span class="cm-operator">=</span><span class="cm-keyword">None</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-operator">...</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable-2">self</span>.<span class="cm-property">double_q</span> <span class="cm-operator">=</span> <span class="cm-variable">double_q</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">sess</span> <span class="cm-keyword">is</span> <span class="cm-keyword">None</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable-2">self</span>.<span class="cm-property">sess</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">Session</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable-2">self</span>.<span class="cm-property">sess</span>.<span class="cm-property">run</span>(<span class="cm-variable">tf</span>.<span class="cm-property">global_variables_initializer</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">else</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable-2">self</span>.<span class="cm-property">sess</span> <span class="cm-operator">=</span> <span class="cm-variable">sess</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-operator">...</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 0px solid transparent; top: 217px;"></div><div class="CodeMirror-gutters" style="height: 252px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div><div class="CodeMirror-gutter CodeMirror-foldgutter"></div><div class="CodeMirror-gutter CodeMirror-lint-markers"></div></div></div></div> <div> <button class="userSubmitBtn scriptRunBtn" onclick="evaluatePython(this);" disabled="" id="scriptRunBtn-0"></button> <button class="userSubmitBtn scriptAddBtn" onclick="addCodeArea(this);" disabled="" id="scriptAddBtn-0"></button> </div> <div class="scriptOutput" id="scriptOutput-0"></div> <img src="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN" class="scriptImage" id="scriptImage-0"></div> <p>接着我们来修改 <code>learn()</code> 中的代码. 我们对比 Double DQN 和 Natural DQN 在 tensorboard 中的图, 发现他们的结构并没有不同, 但是在计算 <code>q_target</code> 的时候, 方法是不同的.</p> <p><a href="https://static.mofanpy.com/static/results/reinforcement-learning/4-5-3.png" target="_blank"><img class="course-image lazy-img" src="./Double DQN _ 莫烦Python_files/loading.gif" data-src="https://static.mofanpy.com/static/results/reinforcement-learning/4-5-3.png" alt="4-5-3.png" title="4-5-3.png"></a></p> <div><textarea class="scriptInput" style="display: none;">class DoubleDQN:
    def learn(self):
        # 这一段和 DQN 一样:
        if self.learn_step_counter % self.replace_target_iter == 0:
            self.sess.run(self.replace_target_op)
            print('\ntarget_params_replaced\n')

        if self.memory_counter &gt; self.memory_size:
            sample_index = np.random.choice(self.memory_size, size=self.batch_size)
        else:
            sample_index = np.random.choice(self.memory_counter, size=self.batch_size)
        batch_memory = self.memory[sample_index, :]

        # 这一段和 DQN 不一样
        q_next, q_eval4next = self.sess.run(
            [self.q_next, self.q_eval],
            feed_dict={self.s_: batch_memory[:, -self.n_features:],    # next observation
                       self.s: batch_memory[:, -self.n_features:]})    # next observation
        q_eval = self.sess.run(self.q_eval, {self.s: batch_memory[:, :self.n_features]})
        q_target = q_eval.copy()
        batch_index = np.arange(self.batch_size, dtype=np.int32)
        eval_act_index = batch_memory[:, self.n_features].astype(int)
        reward = batch_memory[:, self.n_features + 1]

        if self.double_q:   # 如果是 Double DQN
            max_act4next = np.argmax(q_eval4next, axis=1)        # q_eval 得出的最高奖励动作
            selected_q_next = q_next[batch_index, max_act4next]  # Double DQN 选择 q_next 依据 q_eval 选出的动作
        else:       # 如果是 Natural DQN
            selected_q_next = np.max(q_next, axis=1)    # natural DQN

        q_target[batch_index, eval_act_index] = reward + self.gamma * selected_q_next


        # 这下面和 DQN 一样:
        _, self.cost = self.sess.run([self._train_op, self.loss],
                                     feed_dict={self.s: batch_memory[:, :self.n_features],
                                                self.q_target: q_target})
        self.cost_his.append(self.cost)
        self.epsilon = self.epsilon + self.epsilon_increment if self.epsilon &lt; self.epsilon_max else self.epsilon_max
        self.learn_step_counter += 1
</textarea><div class="CodeMirror cm-s-darcula" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; min-height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 15px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 39px;"><div style="height: 100%; min-height: 1px; width: 979px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 15px; width: 15px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: -15px; border-right-width: 35px; min-height: 787px; min-width: 979.07px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">DoubleDQN</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">def</span> <span class="cm-def">learn</span>(<span class="cm-variable-2">self</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># 这一段和 DQN 一样:</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable-2">self</span>.<span class="cm-property">learn_step_counter</span> <span class="cm-operator">%</span> <span class="cm-variable-2">self</span>.<span class="cm-property">replace_target_iter</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable-2">self</span>.<span class="cm-property">sess</span>.<span class="cm-property">run</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">replace_target_op</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-builtin">print</span>(<span class="cm-string">'\ntarget_params_replaced\n'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable-2">self</span>.<span class="cm-property">memory_counter</span> <span class="cm-operator">&gt;</span> <span class="cm-variable-2">self</span>.<span class="cm-property">memory_size</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">sample_index</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">choice</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">memory_size</span>, <span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-variable-2">self</span>.<span class="cm-property">batch_size</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">else</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">sample_index</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">choice</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">memory_counter</span>, <span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-variable-2">self</span>.<span class="cm-property">batch_size</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">batch_memory</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">memory</span>[<span class="cm-variable">sample_index</span>, :]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># 这一段和 DQN 不一样</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">q_next</span>, <span class="cm-variable">q_eval4next</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">sess</span>.<span class="cm-property">run</span>(</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            [<span class="cm-variable-2">self</span>.<span class="cm-property">q_next</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">q_eval</span>],</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">feed_dict</span><span class="cm-operator">=</span>{<span class="cm-variable-2">self</span>.<span class="cm-property">s_</span>: <span class="cm-variable">batch_memory</span>[:, <span class="cm-operator">-</span><span class="cm-variable-2">self</span>.<span class="cm-property">n_features</span>:],    <span class="cm-comment"># next observation</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                       <span class="cm-variable-2">self</span>.<span class="cm-property">s</span>: <span class="cm-variable">batch_memory</span>[:, <span class="cm-operator">-</span><span class="cm-variable-2">self</span>.<span class="cm-property">n_features</span>:]})    <span class="cm-comment"># next observation</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">q_eval</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">sess</span>.<span class="cm-property">run</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">q_eval</span>, {<span class="cm-variable-2">self</span>.<span class="cm-property">s</span>: <span class="cm-variable">batch_memory</span>[:, :<span class="cm-variable-2">self</span>.<span class="cm-property">n_features</span>]})</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">q_target</span> <span class="cm-operator">=</span> <span class="cm-variable">q_eval</span>.<span class="cm-property">copy</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">batch_index</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">batch_size</span>, <span class="cm-variable">dtype</span><span class="cm-operator">=</span><span class="cm-variable">np</span>.<span class="cm-property">int32</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">eval_act_index</span> <span class="cm-operator">=</span> <span class="cm-variable">batch_memory</span>[:, <span class="cm-variable-2">self</span>.<span class="cm-property">n_features</span>].<span class="cm-property">astype</span>(<span class="cm-builtin">int</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">reward</span> <span class="cm-operator">=</span> <span class="cm-variable">batch_memory</span>[:, <span class="cm-variable-2">self</span>.<span class="cm-property">n_features</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable-2">self</span>.<span class="cm-property">double_q</span>:   <span class="cm-comment"># 如果是 Double DQN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">max_act4next</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">q_eval4next</span>, <span class="cm-variable">axis</span><span class="cm-operator">=</span><span class="cm-number">1</span>)        <span class="cm-comment"># q_eval 得出的最高奖励动作</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">selected_q_next</span> <span class="cm-operator">=</span> <span class="cm-variable">q_next</span>[<span class="cm-variable">batch_index</span>, <span class="cm-variable">max_act4next</span>]  <span class="cm-comment"># Double DQN 选择 q_next 依据 q_eval 选出的动作</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">else</span>:       <span class="cm-comment"># 如果是 Natural DQN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">selected_q_next</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">max</span>(<span class="cm-variable">q_next</span>, <span class="cm-variable">axis</span><span class="cm-operator">=</span><span class="cm-number">1</span>)    <span class="cm-comment"># natural DQN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">q_target</span>[<span class="cm-variable">batch_index</span>, <span class="cm-variable">eval_act_index</span>] <span class="cm-operator">=</span> <span class="cm-variable">reward</span> <span class="cm-operator">+</span> <span class="cm-variable-2">self</span>.<span class="cm-property">gamma</span> <span class="cm-operator">*</span> <span class="cm-variable">selected_q_next</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># 这下面和 DQN 一样:</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">_</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">cost</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">sess</span>.<span class="cm-property">run</span>([<span class="cm-variable-2">self</span>.<span class="cm-property">_train_op</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">loss</span>],</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                                     <span class="cm-variable">feed_dict</span><span class="cm-operator">=</span>{<span class="cm-variable-2">self</span>.<span class="cm-property">s</span>: <span class="cm-variable">batch_memory</span>[:, :<span class="cm-variable-2">self</span>.<span class="cm-property">n_features</span>],</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                                                <span class="cm-variable-2">self</span>.<span class="cm-property">q_target</span>: <span class="cm-variable">q_target</span>})</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable-2">self</span>.<span class="cm-property">cost_his</span>.<span class="cm-property">append</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">cost</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable-2">self</span>.<span class="cm-property">epsilon</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">epsilon</span> <span class="cm-operator">+</span> <span class="cm-variable-2">self</span>.<span class="cm-property">epsilon_increment</span> <span class="cm-keyword">if</span> <span class="cm-variable-2">self</span>.<span class="cm-property">epsilon</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">self</span>.<span class="cm-property">epsilon_max</span> <span class="cm-keyword">else</span> <span class="cm-variable-2">self</span>.<span class="cm-property">epsilon_max</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable-2">self</span>.<span class="cm-property">learn_step_counter</span> <span class="cm-operator">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 787px;"></div><div class="CodeMirror-gutters" style="height: 837px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div><div class="CodeMirror-gutter CodeMirror-foldgutter"></div><div class="CodeMirror-gutter CodeMirror-lint-markers"></div></div></div></div> <div> <button class="userSubmitBtn scriptRunBtn" onclick="evaluatePython(this);" disabled="" id="scriptRunBtn-1"></button> <button class="userSubmitBtn scriptAddBtn" onclick="addCodeArea(this);" disabled="" id="scriptAddBtn-1"></button> </div> <div class="scriptOutput" id="scriptOutput-1"></div> <img src="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN" class="scriptImage" id="scriptImage-1"></div><h1 class="tut-h1-pad" id="记录 Q 值">记录 Q 值<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#%E8%AE%B0%E5%BD%95%20Q%20%E5%80%BC" class="headerlink" title="Permalink to this headline">¶</a></h1> <p>为了记录下我们选择动作时的 Q 值, 接下来我们就修改 <code>choose_action()</code> 功能, 让它记录下每次选择的 Q 值.</p> <div><textarea class="scriptInput" style="display: none;">class DoubleDQN:
    def choose_action(self, observation):
        observation = observation[np.newaxis, :]
        actions_value = self.sess.run(self.q_eval, feed_dict={self.s: observation})
        action = np.argmax(actions_value)

        if not hasattr(self, 'q'):  # 记录选的 Qmax 值
            self.q = []
            self.running_q = 0
        self.running_q = self.running_q*0.99 + 0.01 * np.max(actions_value)
        self.q.append(self.running_q)

        if np.random.uniform() &gt; self.epsilon:  # 随机选动作
            action = np.random.randint(0, self.n_actions)
        return action
</textarea><div class="CodeMirror cm-s-darcula" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; min-height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 15px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 39px;"><div style="height: 100%; min-height: 1px; width: 697px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 15px; width: 15px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: -15px; border-right-width: 35px; min-height: 312px; min-width: 696.586px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">DoubleDQN</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">def</span> <span class="cm-def">choose_action</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">observation</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">observation</span> <span class="cm-operator">=</span> <span class="cm-variable">observation</span>[<span class="cm-variable">np</span>.<span class="cm-property">newaxis</span>, :]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">actions_value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">sess</span>.<span class="cm-property">run</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">q_eval</span>, <span class="cm-variable">feed_dict</span><span class="cm-operator">=</span>{<span class="cm-variable-2">self</span>.<span class="cm-property">s</span>: <span class="cm-variable">observation</span>})</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">action</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">actions_value</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-builtin">hasattr</span>(<span class="cm-variable-2">self</span>, <span class="cm-string">'q'</span>):  <span class="cm-comment"># 记录选的 Qmax 值</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable-2">self</span>.<span class="cm-property">q</span> <span class="cm-operator">=</span> []</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable-2">self</span>.<span class="cm-property">running_q</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable-2">self</span>.<span class="cm-property">running_q</span> <span class="cm-operator">=</span> <span class="cm-variable-2">self</span>.<span class="cm-property">running_q</span><span class="cm-operator">*</span><span class="cm-number">0.99</span> <span class="cm-operator">+</span> <span class="cm-number">0.01</span> <span class="cm-operator">*</span> <span class="cm-variable">np</span>.<span class="cm-property">max</span>(<span class="cm-variable">actions_value</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable-2">self</span>.<span class="cm-property">q</span>.<span class="cm-property">append</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">running_q</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">uniform</span>() <span class="cm-operator">&gt;</span> <span class="cm-variable-2">self</span>.<span class="cm-property">epsilon</span>:  <span class="cm-comment"># 随机选动作</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">action</span> <span class="cm-operator">=</span> <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randint</span>(<span class="cm-number">0</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">n_actions</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">return</span> <span class="cm-variable">action</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 312px;"></div><div class="CodeMirror-gutters" style="height: 362px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div><div class="CodeMirror-gutter CodeMirror-foldgutter"></div><div class="CodeMirror-gutter CodeMirror-lint-markers"></div></div></div></div> <div> <button class="userSubmitBtn scriptRunBtn" onclick="evaluatePython(this);" disabled="" id="scriptRunBtn-2"></button> <button class="userSubmitBtn scriptAddBtn" onclick="addCodeArea(this);" disabled="" id="scriptAddBtn-2"></button> </div> <div class="scriptOutput" id="scriptOutput-2"></div> <img src="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN" class="scriptImage" id="scriptImage-2"></div><h1 class="tut-h1-pad" id="对比结果">对比结果<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#%E5%AF%B9%E6%AF%94%E7%BB%93%E6%9E%9C" class="headerlink" title="Permalink to this headline">¶</a></h1> <p>接着我们就来对比 Natural DQN 和 Double DQN 带来的不同结果啦. <a href="https://github.com/MorvanZhou/Reinforcement-learning-with-tensorflow/blob/master/contents/5.1_Double_DQN/run_Pendulum.py" target="_blank">代码在这</a></p> <div><textarea class="scriptInput" style="display: none;">import gym
from RL_brain import DoubleDQN
import numpy as np
import matplotlib.pyplot as plt
import tensorflow as tf


env = gym.make('Pendulum-v0')
env.seed(1) # 可重复实验
MEMORY_SIZE = 3000
ACTION_SPACE = 11    # 将原本的连续动作分离成 11 个动作

sess = tf.Session()
with tf.variable_scope('Natural_DQN'):
    natural_DQN = DoubleDQN(
        n_actions=ACTION_SPACE, n_features=3, memory_size=MEMORY_SIZE,
        e_greedy_increment=0.001, double_q=False, sess=sess
    )

with tf.variable_scope('Double_DQN'):
    double_DQN = DoubleDQN(
        n_actions=ACTION_SPACE, n_features=3, memory_size=MEMORY_SIZE,
        e_greedy_increment=0.001, double_q=True, sess=sess, output_graph=True)

sess.run(tf.global_variables_initializer())


def train(RL):
    total_steps = 0
    observation = env.reset()
    while True:
        # if total_steps - MEMORY_SIZE &gt; 8000: env.render()

        action = RL.choose_action(observation)

        f_action = (action-(ACTION_SPACE-1)/2)/((ACTION_SPACE-1)/4)   # 在 [-2 ~ 2] 内离散化动作

        observation_, reward, done, info = env.step(np.array([f_action]))

        reward /= 10     # normalize 到这个区间 (-1, 0). 立起来的时候 reward = 0.
        # 立起来以后的 Q target 会变成 0, 因为 Q_target = r + gamma * Qmax(s', a') = 0 + gamma * 0
        # 所以这个状态时的 Q 值大于 0 时, 就出现了 overestimate.

        RL.store_transition(observation, action, reward, observation_)

        if total_steps &gt; MEMORY_SIZE:   # learning
            RL.learn()

        if total_steps - MEMORY_SIZE &gt; 20000:   # stop game
            break

        observation = observation_
        total_steps += 1
    return RL.q # 返回所有动作 Q 值

# train 两个不同的 DQN
q_natural = train(natural_DQN)
q_double = train(double_DQN)

# 出对比图
plt.plot(np.array(q_natural), c='r', label='natural')
plt.plot(np.array(q_double), c='b', label='double')
plt.legend(loc='best')
plt.ylabel('Q eval')
plt.xlabel('training steps')
plt.grid()
plt.show()
</textarea><div class="CodeMirror cm-s-darcula" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; min-height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 15px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 39px;"><div style="height: 100%; min-height: 1px; width: 786.602px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 15px; width: 15px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: -15px; border-right-width: 35px; min-height: 1300px; min-width: 786.602px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">gym</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">RL_brain</span> <span class="cm-keyword">import</span> <span class="cm-variable">DoubleDQN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">as</span> <span class="cm-variable">plt</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">tensorflow</span> <span class="cm-keyword">as</span> <span class="cm-variable">tf</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">env</span> <span class="cm-operator">=</span> <span class="cm-variable">gym</span>.<span class="cm-property">make</span>(<span class="cm-string">'Pendulum-v0'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">env</span>.<span class="cm-property">seed</span>(<span class="cm-number">1</span>) <span class="cm-comment"># 可重复实验</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">MEMORY_SIZE</span> <span class="cm-operator">=</span> <span class="cm-number">3000</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ACTION_SPACE</span> <span class="cm-operator">=</span> <span class="cm-number">11</span>    <span class="cm-comment"># 将原本的连续动作分离成 11 个动作</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sess</span> <span class="cm-operator">=</span> <span class="cm-variable">tf</span>.<span class="cm-property">Session</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">with</span> <span class="cm-variable">tf</span>.<span class="cm-property">variable_scope</span>(<span class="cm-string">'Natural_DQN'</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">natural_DQN</span> <span class="cm-operator">=</span> <span class="cm-variable">DoubleDQN</span>(</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">n_actions</span><span class="cm-operator">=</span><span class="cm-variable">ACTION_SPACE</span>, <span class="cm-variable">n_features</span><span class="cm-operator">=</span><span class="cm-number">3</span>, <span class="cm-variable">memory_size</span><span class="cm-operator">=</span><span class="cm-variable">MEMORY_SIZE</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">e_greedy_increment</span><span class="cm-operator">=</span><span class="cm-number">0.001</span>, <span class="cm-variable">double_q</span><span class="cm-operator">=</span><span class="cm-keyword">False</span>, <span class="cm-variable">sess</span><span class="cm-operator">=</span><span class="cm-variable">sess</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    )</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">with</span> <span class="cm-variable">tf</span>.<span class="cm-property">variable_scope</span>(<span class="cm-string">'Double_DQN'</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">double_DQN</span> <span class="cm-operator">=</span> <span class="cm-variable">DoubleDQN</span>(</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">n_actions</span><span class="cm-operator">=</span><span class="cm-variable">ACTION_SPACE</span>, <span class="cm-variable">n_features</span><span class="cm-operator">=</span><span class="cm-number">3</span>, <span class="cm-variable">memory_size</span><span class="cm-operator">=</span><span class="cm-variable">MEMORY_SIZE</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">e_greedy_increment</span><span class="cm-operator">=</span><span class="cm-number">0.001</span>, <span class="cm-variable">double_q</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>, <span class="cm-variable">sess</span><span class="cm-operator">=</span><span class="cm-variable">sess</span>, <span class="cm-variable">output_graph</span><span class="cm-operator">=</span><span class="cm-keyword">True</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sess</span>.<span class="cm-property">run</span>(<span class="cm-variable">tf</span>.<span class="cm-property">global_variables_initializer</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">train</span>(<span class="cm-variable">RL</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">total_steps</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">observation</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-property">reset</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">while</span> <span class="cm-keyword">True</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># if total_steps - MEMORY_SIZE &gt; 8000: env.render()</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">action</span> <span class="cm-operator">=</span> <span class="cm-variable">RL</span>.<span class="cm-property">choose_action</span>(<span class="cm-variable">observation</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">f_action</span> <span class="cm-operator">=</span> (<span class="cm-variable">action</span><span class="cm-operator">-</span>(<span class="cm-variable">ACTION_SPACE</span><span class="cm-operator">-</span><span class="cm-number">1</span>)<span class="cm-operator">/</span><span class="cm-number">2</span>)<span class="cm-operator">/</span>((<span class="cm-variable">ACTION_SPACE</span><span class="cm-operator">-</span><span class="cm-number">1</span>)<span class="cm-operator">/</span><span class="cm-number">4</span>)   <span class="cm-comment"># 在 [-2 ~ 2] 内离散化动作</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">observation_</span>, <span class="cm-variable">reward</span>, <span class="cm-variable">done</span>, <span class="cm-variable">info</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-property">step</span>(<span class="cm-variable">np</span>.<span class="cm-property">array</span>([<span class="cm-variable">f_action</span>]))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">reward</span> <span class="cm-operator">/=</span> <span class="cm-number">10</span>     <span class="cm-comment"># normalize 到这个区间 (-1, 0). 立起来的时候 reward = 0.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># 立起来以后的 Q target 会变成 0, 因为 Q_target = r + gamma * Qmax(s', a') = 0 + gamma * 0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">42</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># 所以这个状态时的 Q 值大于 0 时, 就出现了 overestimate.</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">43</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">44</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">RL</span>.<span class="cm-property">store_transition</span>(<span class="cm-variable">observation</span>, <span class="cm-variable">action</span>, <span class="cm-variable">reward</span>, <span class="cm-variable">observation_</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">45</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">46</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">total_steps</span> <span class="cm-operator">&gt;</span> <span class="cm-variable">MEMORY_SIZE</span>:   <span class="cm-comment"># learning</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">47</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">RL</span>.<span class="cm-property">learn</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">48</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">49</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">total_steps</span> <span class="cm-operator">-</span> <span class="cm-variable">MEMORY_SIZE</span> <span class="cm-operator">&gt;</span> <span class="cm-number">20000</span>:   <span class="cm-comment"># stop game</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">50</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-keyword">break</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">51</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">52</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">observation</span> <span class="cm-operator">=</span> <span class="cm-variable">observation_</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">53</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">total_steps</span> <span class="cm-operator">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">54</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">RL</span>.<span class="cm-property">q</span> <span class="cm-comment"># 返回所有动作 Q 值</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">55</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">56</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># train 两个不同的 DQN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">57</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">q_natural</span> <span class="cm-operator">=</span> <span class="cm-variable">train</span>(<span class="cm-variable">natural_DQN</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">58</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">q_double</span> <span class="cm-operator">=</span> <span class="cm-variable">train</span>(<span class="cm-variable">double_DQN</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">59</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">60</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 出对比图</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">61</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">plot</span>(<span class="cm-variable">np</span>.<span class="cm-property">array</span>(<span class="cm-variable">q_natural</span>), <span class="cm-variable">c</span><span class="cm-operator">=</span><span class="cm-string">'r'</span>, <span class="cm-variable">label</span><span class="cm-operator">=</span><span class="cm-string">'natural'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">62</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">plot</span>(<span class="cm-variable">np</span>.<span class="cm-property">array</span>(<span class="cm-variable">q_double</span>), <span class="cm-variable">c</span><span class="cm-operator">=</span><span class="cm-string">'b'</span>, <span class="cm-variable">label</span><span class="cm-operator">=</span><span class="cm-string">'double'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">63</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">legend</span>(<span class="cm-variable">loc</span><span class="cm-operator">=</span><span class="cm-string">'best'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">64</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">ylabel</span>(<span class="cm-string">'Q eval'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">65</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">xlabel</span>(<span class="cm-string">'training steps'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">66</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">grid</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">67</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">68</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 1300px;"></div><div class="CodeMirror-gutters" style="height: 1350px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div><div class="CodeMirror-gutter CodeMirror-foldgutter"></div><div class="CodeMirror-gutter CodeMirror-lint-markers"></div></div></div></div> <div> <button class="userSubmitBtn scriptRunBtn" onclick="evaluatePython(this);" disabled="" id="scriptRunBtn-3"></button> <button class="userSubmitBtn scriptAddBtn" onclick="addCodeArea(this);" disabled="" id="scriptAddBtn-3"></button> </div> <div class="scriptOutput" id="scriptOutput-3"></div> <img src="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN" class="scriptImage" id="scriptImage-3"></div> <p>所以这个出来的图是这样:</p> <p><a href="https://static.mofanpy.com/static/results/reinforcement-learning/4-5-4.png" target="_blank"><img class="course-image lazy-img" src="./Double DQN _ 莫烦Python_files/loading.gif" data-src="https://static.mofanpy.com/static/results/reinforcement-learning/4-5-4.png" alt="4-5-4.png" title="4-5-4.png"></a></p> <p>可以看出, Natural DQN 学得差不多后, 在立起来时, 大部分时间都是 估计的 Q值 要大于0, 这时就出现了 overestimate, 而 Double DQN 的 Q值 就消除了一些 overestimate, 将估计值保持在 0 左右.</p> <div id="bottom-donation-section"> <hr> <h3 id="bottom-donation-title">降低知识传递的门槛</h3> <div class="hover-move"> <a id="bottom-donation-button" href="https://mofanpy.com/support"><b>支持莫烦</b></a> </div> <p> 莫烦经常从互联网上学习知识，开源分享的人是我学习的榜样。 他们的行为也改变了我对教育的态度: <b>降低知识传递的门槛</b>。 <b>免费</b> 奉献我的所学正是受这种态度的影响。 <a href="https://mofanpy.com/support">【支持莫烦】</a> 能让我感到认同，我也更有理由坚持下去。 </p> <p> 我组建了微信群，欢迎大家加入，一起讨论学习问题。 </p> <a href="https://mofanpy.com/static/img/description/mofanpyQR.png"> <img class="lazy-img" src="./Double DQN _ 莫烦Python_files/mofanpyQR.png" alt="wechat" style="width:50%;padding:10px;margin-left: auto;margin-right: auto;display: block"> </a> </div> </div> <div class="pad-page-navigation"> <div class="PageNavigation"> <a class="prev" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym"> <b>«</b> OpenAI gym 环境库</a> <a class="next" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/prioritized-replay"> Prioritized Experience Replay (DQN) <b>»</b></a> </div> </div> </div> <div class="section ie-size"> <div class="comment-section"> <button onclick="commentSortDateSwitch(&#39;https://mofanpy.com/api/comment&#39;, 54)" value="oldFirst" id="comment-sort-btn" class="comment-btn" style="margin: 0 0 2em 0;"> ⇌ 展示最早 </button> <div class="comment-page-nav" id="comment-page-nav1"><button class="comment-page-nav-btn" style="color: rgb(217, 217, 217);">1</button><button class="comment-page-nav-btn">2</button><button class="comment-page-nav-btn">下一页</button></div> <ul class="comments" id="bottom-comments-ul"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/7D07D605BE5D506E666B320B14E39CC9.jpeg"></div><div class="comment-content" id="comment-content-div-3043"><div class="comment-author">来都来了</div><div class="comment-date">03-16</div><div class="comment-body-hidden" id="comment-hidden-id-3043">莫烦老师您好，请问我想基于走迷宫的例子用DQN实现全覆盖，可行吗，我编写环境之后，训练300多次还是只是以全覆盖完为显示效果，但是覆盖路径很乱，乱跳，谢谢老师</div><div class="comment-body" id="comment-id-3043">莫烦老师您好，请问我想基于走迷宫的例子用DQN实现全覆盖，可行吗，我编写环境之后，训练300多次还是只是以全覆盖完为显示效果，但是覆盖路径很乱，乱跳，谢谢老师</div><button class="comment-like-btn comment-btn" id="like-btn-id-3043"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-3043">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-3043"></div><div class="comment-reply-div" id="comment-reply-id-3043"></div><ul class="reply-ul" id="reply-ul-id-3043"></ul></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/551FF0BE824BD124743A4C6833315FFC.jpeg"></div><div class="comment-content" id="comment-content-div-1795"><div class="comment-author">西</div><div class="comment-date">2021-11-22</div><div class="comment-body-hidden" id="comment-hidden-id-1795">莫烦老师，这里Qmax(s&amp;#x27;, a&amp;#x27;)和rewardmax是一样的吗</div><div class="comment-body" id="comment-id-1795">莫烦老师，这里Qmax(s', a')和rewardmax是一样的吗</div><button class="comment-like-btn comment-btn" id="like-btn-id-1795"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1795">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1795"></div><div class="comment-reply-div" id="comment-reply-id-1795"></div><ul class="reply-ul" id="reply-ul-id-1795"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/my_pic.jpg"></div><div class="comment-content" id="comment-content-div-1806"><div class="comment-author comment-author-admin">莫烦Python</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">西 ⤴</div><div class="comment-date">2021-11-23</div><div class="comment-body-hidden" id="comment-hidden-id-1806">不一样，这是用神经网络评估出来的，对未来的价值评估。和 reward 不一样。</div><div class="comment-body" id="comment-id-1806">不一样，这是用神经网络评估出来的，对未来的价值评估。和 reward 不一样。</div><button class="comment-like-btn comment-btn" id="like-btn-id-1806"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1806">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1806"></div><div class="comment-reply-div" id="comment-reply-id-1806"></div></li></ul></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/503017F4B608584A06449F7287BD5829.png"></div><div class="comment-content" id="comment-content-div-1517"><div class="comment-author">小钱</div><div class="comment-date">2021-09-24</div><div class="comment-body-hidden" id="comment-hidden-id-1517">(action-(ACTION_SPACE-1)/2)/((ACTION_SPACE-1)/4) 
请问这个是根据 action 的索引号，计算出离散后，该索引区间的最小值么？
难道不应该是 -2+4/(ACTION_SPACE-1)*action 么？
这个计算方法真心看不懂啊，最好能注明一下思路</div><div class="comment-body" id="comment-id-1517">(action-(ACTION_SPACE-1)/2)/((ACTION_SPACE-1)/4) <br>请问这个是根据 action 的索引号，计算出离散后，该索引区间的最小值么？<br>难道不应该是 -2+4/(ACTION_SPACE-1)*action 么？<br>这个计算方法真心看不懂啊，最好能注明一下思路</div><button class="comment-like-btn comment-btn" id="like-btn-id-1517"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1517">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1517"></div><div class="comment-reply-div" id="comment-reply-id-1517"></div><ul class="reply-ul" id="reply-ul-id-1517"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/B644E01BD8DBB7F9F3E0F0D554BA9723.jpeg"></div><div class="comment-content" id="comment-content-div-3124"><div class="comment-author">➡️🆒🎶</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">小钱 ⤴</div><div class="comment-date">07-17</div><div class="comment-body-hidden" id="comment-hidden-id-3124">你好，我在observation，action，f_action等几个地方都print了一下得到这样的结论：这个操作就是把[0,1,2,...,10]这个离散空间，re-scaling一下，使范围重新回到环境定义的[-2,2]这个区间里，不过还是离散的.[-2,-1.6,-1.2,-0.8,...,1.6,2.0]这样。原因是莫烦老师说了这里DQN依然希望采用离散的输出，我们人为可以将这个[-2,2]的区间等分成11份，代码中可以看到action_space=11，那么神经网络layer2也就会有11个神经元，对应action0～action10的11个Q值的输出，然后action=RL.choose_action(observation)这里，得到的action也是action的索引，是0～10的某一个数，最后用这个计算，再转化成[-2,2]区间内的数，用来存储和训练，因为这个肯定还是比0～10要合理</div><div class="comment-body" id="comment-id-3124">你好，我在observation，action，f_action等几个地方都print了一下得到这样的结论：这个操作就是把[0,1,2,...,10]这个离散空间，re-scaling一下，使范围重新回到环境定义的[-2,2]这个区间里，不过还是离散的.[-2,-1.6,-1.2,-0.8,...,1.6,2.0]这样。原因是莫烦老师说了这里DQN依然希望采用离散的输出，我们人为可以将这个[-2,2]的区间等分成11份，代码中可以看到action_space=11，那么神经网络layer2也就会有11个神经元，对应action0～action10的11个Q值的输出，然后action=RL.choose_action(observation)这里，得到的action也是action的索引，是0～10的某一个数，最后用这个计算，再转化成[-2,2]区间内的数，用来存储和训练，因为这个肯定还是比0～10要合理</div><button class="comment-like-btn comment-btn" id="like-btn-id-3124"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-3124">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-3124"></div><div class="comment-reply-div" id="comment-reply-id-3124"></div></li></ul></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/642C056065626D3B9FD29151E3E57A68.png"></div><div class="comment-content" id="comment-content-div-614"><div class="comment-author">白幽灵</div><div class="comment-date">2021-01-21</div><div class="comment-body-hidden" id="comment-hidden-id-614">莫烦老师您好，我在Double DQN代码时，看到了choose_action这个函数里面的 action = np.argmax(actions_value)，这个选出来的好像是只有一个值，可是如果想要action是多维的，这个该如何处理呀，因为这个又要与q_eval,不知是否又要改变神经网络的结构，想了好久也没太能理解，老师有空能指点下一二嘛？</div><div class="comment-body" id="comment-id-614">莫烦老师您好，我在Double DQN代码时，看到了choose_action这个函数里面的 action = np.argmax(actions_value)，这个选出来的好像是只有一个值，可是如果想要action是多维的，这个该如何处理呀，因为这个又要与q_eval,不知是否又要改变神经网络的结构，想了好久也没太能理解，老师有空能指点下一二嘛？</div><button class="comment-like-btn comment-btn" id="like-btn-id-614"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-614">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-614"></div><div class="comment-reply-div" id="comment-reply-id-614"></div><ul class="reply-ul" id="reply-ul-id-614"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/my_pic.jpg"></div><div class="comment-content" id="comment-content-div-620"><div class="comment-author comment-author-admin">莫烦Python</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">白幽灵 ⤴</div><div class="comment-date">2021-01-22</div><div class="comment-body-hidden" id="comment-hidden-id-620">每一个维度选择一个最大值</div><div class="comment-body" id="comment-id-620">每一个维度选择一个最大值</div><button class="comment-like-btn comment-btn" id="like-btn-id-620"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-620">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-620"></div><div class="comment-reply-div" id="comment-reply-id-620"></div></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/642C056065626D3B9FD29151E3E57A68.png"></div><div class="comment-content" id="comment-content-div-623"><div class="comment-author">白幽灵</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier comment-author-admin">莫烦Python ⤴</div><div class="comment-date">2021-01-22</div><div class="comment-body-hidden" id="comment-hidden-id-623">因为想要通过神经网络得到的最优的action是多维，那选出来的action应该是每个维度对应的Q的最大值，那这样的话是不是q_eval跟q_target是否也是跟action一样对应维度的呢？非常感谢老师的回答</div><div class="comment-body" id="comment-id-623">因为想要通过神经网络得到的最优的action是多维，那选出来的action应该是每个维度对应的Q的最大值，那这样的话是不是q_eval跟q_target是否也是跟action一样对应维度的呢？非常感谢老师的回答</div><button class="comment-like-btn comment-btn" id="like-btn-id-623"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-623">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-623"></div><div class="comment-reply-div" id="comment-reply-id-623"></div></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/my_pic.jpg"></div><div class="comment-content" id="comment-content-div-626"><div class="comment-author comment-author-admin">莫烦Python</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">白幽灵 ⤴</div><div class="comment-date">2021-01-24</div><div class="comment-body-hidden" id="comment-hidden-id-626">假设出来的action是[batch, dim, n]的维度，q可以也是输出[batch, dim, n]，在每一个dim的某个n上施加q，反向传播。我还没这么用过，不过如果我遇到这样的问题，首先会尝试这样写</div><div class="comment-body" id="comment-id-626">假设出来的action是[batch, dim, n]的维度，q可以也是输出[batch, dim, n]，在每一个dim的某个n上施加q，反向传播。我还没这么用过，不过如果我遇到这样的问题，首先会尝试这样写</div><button class="comment-like-btn comment-btn" id="like-btn-id-626"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-626">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-626"></div><div class="comment-reply-div" id="comment-reply-id-626"></div></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/642C056065626D3B9FD29151E3E57A68.png"></div><div class="comment-content" id="comment-content-div-628"><div class="comment-author">白幽灵</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier comment-author-admin">莫烦Python ⤴</div><div class="comment-date">2021-01-24</div><div class="comment-body-hidden" id="comment-hidden-id-628">好的，非常感谢老师</div><div class="comment-body" id="comment-id-628">好的，非常感谢老师</div><button class="comment-like-btn comment-btn" id="like-btn-id-628"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-628">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-628"></div><div class="comment-reply-div" id="comment-reply-id-628"></div></li></ul></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/default_user_icon.png"></div><div class="comment-content" id="comment-content-div-589"><div class="comment-author">没有名字莫烦粉丝</div><div class="comment-date">2021-01-05</div><div class="comment-body-hidden" id="comment-hidden-id-589">莫烦老师，为什么记录Q值时是这么个式子呢？self.running_q = self.running_q*0.99 + 0.01 * np.max(actions_value)
0.99和0.01有什么含义？直接记录np.max(actions_value)不行吗？</div><div class="comment-body" id="comment-id-589">莫烦老师，为什么记录Q值时是这么个式子呢？self.running_q = self.running_q*0.99 + 0.01 * np.max(actions_value)<br>0.99和0.01有什么含义？直接记录np.max(actions_value)不行吗？</div><button class="comment-like-btn comment-btn" id="like-btn-id-589"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>1</button><button class="hide-button comment-btn" id="reply-btn-id-589">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-589"></div><div class="comment-reply-div" id="comment-reply-id-589"></div><ul class="reply-ul" id="reply-ul-id-589"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/my_pic.jpg"></div><div class="comment-content" id="comment-content-div-590"><div class="comment-author comment-author-admin">莫烦Python</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">没有名字莫烦粉丝 ⤴</div><div class="comment-date">2021-01-05</div><div class="comment-body-hidden" id="comment-hidden-id-590">可以直接`np.max(actions_value)`, 我是为了让图变得顺滑一点，所以用了smooth的方法</div><div class="comment-body" id="comment-id-590">可以直接<span><code class="plaintext hljs" style="display: inline-block; color: rgb(254, 113, 113); background-color: rgb(229, 232, 232); overflow-x: inherit; padding: 0px 4px; font-size: 1em;">np.max(actions_value)</code></span>, 我是为了让图变得顺滑一点，所以用了smooth的方法</div><button class="comment-like-btn comment-btn" id="like-btn-id-590"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>2</button><button class="hide-button comment-btn" id="reply-btn-id-590">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-590"></div><div class="comment-reply-div" id="comment-reply-id-590"></div></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./Double DQN _ 莫烦Python_files/default_user_icon.png"></div><div class="comment-content" id="comment-content-div-591"><div class="comment-author">没有名字莫烦粉丝</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier comment-author-admin">莫烦Python ⤴</div><div class="comment-date">2021-01-05</div><div class="comment-body-hidden" id="comment-hidden-id-591">懂了，谢谢莫烦老师！</div><div class="comment-body" id="comment-id-591">懂了，谢谢莫烦老师！</div><button class="comment-like-btn comment-btn" id="like-btn-id-591"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-591">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-591"></div><div class="comment-reply-div" id="comment-reply-id-591"></div></li></ul></li></ul> <div class="comment-page-nav" id="comment-page-nav2"><button class="comment-page-nav-btn" style="color: rgb(217, 217, 217);">1</button><button class="comment-page-nav-btn">2</button><button class="comment-page-nav-btn">下一页</button></div> <script async="">
    commentGet('https://mofanpy.com/api/comment', "54", )
  </script> </div> <ins class="adsbygoogle" style="display: block; text-align: center; height: 175px;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-4601203457616636" data-ad-slot="3952173485" data-adsbygoogle-status="done"><div id="aswift_3_host" style="border: none; height: 175px; width: 700px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins> <div class="comment-section"> <div class="comment-reply-tools-div" id="comment-reply-tools-div-0" style="margin-left: 0"></div> <div style="display: flex;"> <textarea class="comment-textarea" name="comments" id="comment-textarea-main" oninput="this.style.height = &quot;&quot;;this.style.height = this.scrollHeight + &quot;px&quot;" maxlength="2000" disabled="disabled" placeholder="留言请先登录"></textarea> <button class="comment-submit-btn" id="comment-submit" onclick="commentPut(&#39;https://mofanpy.com/api/comment&#39;, &#39;54&#39;, null, null, &#39;comment-textarea-main&#39;)"> 登录 </button> </div> <script type="text/javascript">
    $(document).ready(function () {
      if ('False' === "True") {
          $("#comment-submit").text("发布");
        $("#comment-reply-tools-div-0").append(
          $("<button>", {
            class: "comment-btn",
          }).on("click", function () {
            insertCodePlaceholder(0, 'comment-textarea-main')
          }).html("&#60;&#47;&#62;")
            .append($("<span>", {
              class: "tooltiptext",
              text: "选中多行代码高亮"
            }))
        )
      }
    })
    if ('False' === "False") {
        $("#comment-textarea-main").attr("disabled", true).prop("placeholder", "留言请先登录");
    } else {
      $("#comment-textarea-main").attr("disabled", false
      ).prop("placeholder", "")
    }
    $(".comment-textarea").on("keydown", textareaKeydown);
  </script> </div> </div> <div class="tut-content-menu"> <a class="hover-move" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/"> <img src="./Double DQN _ 莫烦Python_files/tutorial_contents_icon.jpg" alt="教程目录"></a> </div> </div> <div class="tut-right-bar"> <div class="tut-table-content-nav section" id="tut-table-content-nav-scroll"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/"><p><b>强化学习 (Reinforcement Learning)</b></p></a> <ul class="tut-table-content-nav-contents"> <p>简介</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-RL">什么是强化学习</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-RL-methods">强化学习方法汇总</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/why">为什么用强化学习 Why?</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/requirment">课程要求</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Q-learning</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-q-learning">什么是 Q Leaning</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/general-rl">小例子</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-q1">Q-learning 算法更新</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-q2">Q-learning 思维决策</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Sarsa</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-sarsa">什么是 Sarsa</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-sarsa1">Sarsa 算法更新</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-sarsa2">Sarsa 思维决策</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-sarsa-lambda">什么是 Sarsa(lambda)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-sarsa-lambda">Sarsa-lambda</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Deep Q Network</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-DQN">什么是 DQN</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN1">DQN 算法更新</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN2">DQN 神经网络</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN3">DQN 思维决策</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym">OpenAI gym 环境库</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN" style="color:#ffffff;" id="nav-to-this-li">Double DQN</a> <ul style="padding-left: 1em"> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#%E8%A6%81%E7%82%B9" style="color:#ffffff;">要点</a> </li> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#Double%20DQN%20%E7%AE%97%E6%B3%95" style="color:#ffffff;">Double DQN 算法</a> </li> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#%E6%9B%B4%E6%96%B0%E6%96%B9%E6%B3%95" style="color:#ffffff;">更新方法</a> </li> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#%E8%AE%B0%E5%BD%95%20Q%20%E5%80%BC" style="color:#ffffff;">记录 Q 值</a> </li> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN#%E5%AF%B9%E6%AF%94%E7%BB%93%E6%9E%9C" style="color:#ffffff;">对比结果</a> </li> </ul> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/prioritized-replay">Prioritized Experience Replay (DQN)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/dueling-DQN">Dueling DQN</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Policy Gradient</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-PG">什么是 Policy Gradients</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/policy-gradient-softmax1">Policy Gradients 算法更新</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/policy-gradient-softmax2">Policy Gradients 思维决策</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Actor Critic</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-AC">什么是 Actor Critic</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/actor-critic">Actor Critic</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-DDPG">什么是 DDPG</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DDPG">Deep Deterministic Policy Gradient (DDPG)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-A3C">什么是 Asynchronous Advantage Actor-Critic (A3C)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/A3C">Asynchronous Advantage Actor-Critic (A3C)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DPPO">Distributed Proximal Policy Optimization (DPPO)</a> </li> </ul> <script type="text/javascript" async="">
            let myElement = document.getElementById(id = "nav-to-this-li");
            let topPos = myElement.offsetTop;
            document.getElementById('tut-table-content-nav-scroll').scrollTop = topPos - 30;
        </script> </div> <div class="section ie-size" id="right-fix-ads"> <script async="" src="./Double DQN _ 莫烦Python_files/f(7).txt" crossorigin="anonymous" data-checked-head="true"></script> <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-4601203457616636" data-ad-slot="8101278819" data-adsbygoogle-status="done" data-ad-status="filled"><div id="aswift_4_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 250px; width: 300px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_4" name="aswift_4" style="left:0;position:absolute;top:0;border:0;width:300px;height:250px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="300" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./Double DQN _ 莫烦Python_files/ads(2).html" data-google-container-id="a!5" data-google-query-id="CPXfkf6Hx4ADFROilgodkYUEQw" data-load-complete="true"></iframe></div></ins> </div> <div class="section ie-size" id="right-fix-ads"> <script async="" src="./Double DQN _ 莫烦Python_files/f(7).txt" crossorigin="anonymous" data-checked-head="true"></script> <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-4601203457616636" data-ad-slot="5136097798" data-adsbygoogle-status="done" data-ad-status="filled"><div id="aswift_5_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 250px; width: 300px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_5" name="aswift_5" style="left:0;position:absolute;top:0;border:0;width:300px;height:250px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="300" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./Double DQN _ 莫烦Python_files/ads(3).html" data-google-container-id="a!6" data-google-query-id="CMnxkf6Hx4ADFcqllgodH7wGQQ" data-load-complete="true"></iframe></div></ins> </div> </div> <div id="video-container-small-btns" style="display: block;"><button>&lt;&lt;</button><button>↑</button></div></main> <footer> <p>关注我的动向:</p> <ul> <li><a href="https://github.com/MorvanZhou" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 24 24"> <path d="M12 1A10.89 10.89 0 0 0 1 11.77 10.79 10.79 0 0 0 8.52 22c.55.1.75-.23.75-.52v-1.83c-3.06.65-3.71-1.44-3.71-1.44a2.86 2.86 0 0 0-1.22-1.58c-1-.66.08-.65.08-.65a2.31 2.31 0 0 1 1.68 1.11 2.37 2.37 0 0 0 3.2.89 2.33 2.33 0 0 1 .7-1.44c-2.44-.27-5-1.19-5-5.32a4.15 4.15 0 0 1 1.11-2.91 3.78 3.78 0 0 1 .11-2.84s.93-.29 3 1.1a10.68 10.68 0 0 1 5.5 0c2.1-1.39 3-1.1 3-1.1a3.78 3.78 0 0 1 .11 2.84A4.15 4.15 0 0 1 19 11.2c0 4.14-2.58 5.05-5 5.32a2.5 2.5 0 0 1 .75 2v2.95c0 .35.2.63.75.52A10.8 10.8 0 0 0 23 11.77 10.89 10.89 0 0 0 12 1"></path> </svg> </a></li> <li><a href="https://gitee.com/MorvanZhou" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 32 32"> <g fill="none" fill-rule="evenodd"> <circle cx="16" cy="16" fill="#4a4a4a" r="16"></circle> <path d="m24.0987698 14.2225144h-9.0863697c-.4362899.000207-.7900048.3538292-.790326.7901191l-.0005173 1.9752185c-.0003277.4363707.353328.7902117.7896987.790326.0000712 0 .0001424 0 .0002135-.0002135l5.5317648-.0000461c.4363708-.0000102.7901221.3537352.7901257.790106 0 .0000022 0 .0000044-.0000066.0000066v.1975077.1975318c0 1.3091122-1.0612451 2.3703573-2.3703573 2.3703573h-7.5067195c-.4363081-.0000218-.790009-.353713-.7900429-.7900211l-.0002069-7.5059917c-.0001014-1.3091122 1.0611145-2.3703865 2.3702267-2.3704226.0000217 0 .0000435 0 .0000653.0000653h11.0602463c.4361793-.0004902.7898484-.35394.7906091-.79011894l.0012251-1.97521881c.0007606-.43637034-.3527683-.79033806-.7891389-.79060871-.0001634-.0000001-.0003268-.00000015-.0004901.00048976h-11.0617654c-3.27278051 0-5.92589329 2.65311278-5.92589329 5.9258933v11.0612755c0 .4363707.35374837.7901191.7901191.7901191h11.65447149c2.9454379 0 5.3331872-2.3877493 5.3331872-5.3331872v-4.5430682c0-.4363707-.3537484-.7901191-.7901191-.7901191z" fill="#02c39a"></path> </g> </svg> </a></li> <li><a href="https://www.youtube.com/user/MorvanZhou" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 24 24"> <path d="M23,9.71a8.5,8.5,0,0,0-.91-4.13,2.92,2.92,0,0,0-1.72-1A78.36,78.36,0,0,0,12,4.27a78.45,78.45,0,0,0-8.34.3,2.87,2.87,0,0,0-1.46.74c-.9.83-1,2.25-1.1,3.45a48.29,48.29,0,0,0,0,6.48,9.55,9.55,0,0,0,.3,2,3.14,3.14,0,0,0,.71,1.36,2.86,2.86,0,0,0,1.49.78,45.18,45.18,0,0,0,6.5.33c3.5.05,6.57,0,10.2-.28a2.88,2.88,0,0,0,1.53-.78,2.49,2.49,0,0,0,.61-1,10.58,10.58,0,0,0,.52-3.4C23,13.69,23,10.31,23,9.71ZM9.74,14.85V8.66l5.92,3.11C14,12.69,11.81,13.73,9.74,14.85Z"></path> </svg> </a></li> <li><a href="https://space.bilibili.com/243821484#!/" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 1000 1000"> <path d="M957.6,281.2c0-29.1-4.8-33.9-33.9-33.9c-95.3,0-190.6,0-285.1,0h-25.8c27.5-40.4,52.5-76.7,76.7-113.1c17.8-25.8,35.5-52.5,53.3-78.3c9.7-13.7,12.1-28.3-2.4-40.4C727.4,5,712.8,9.8,700.7,27.6c-1.6,2.4-3.2,4.8-4.8,6.5c-43.6,64.6-88,129.2-131.7,193c-14.5,21-54.1,28.3-75.9,15.3C401.9,194.8,315.4,148,229,101.1c-14.5-8.1-29.1-7.3-37.2,8.9c-8.1,15.3-2.4,28.3,12.9,36.3c37.2,20.2,73.5,40.4,110.7,60.6c22.6,12.1,44.4,24.2,67,36.3c-0.8,1.6-1.6,3.2-1.6,4.8h-20.2c-96.1,0-191.4,0-287.5,0c-23.4,0-31.5,7.3-31.5,28.3C40.8,478.3,40.8,681,40.8,883c0,20.2,8.9,28.3,29.1,29.1c18.6,0,37.2,0.8,55.7,0c14.5-0.8,21,2.4,25.8,18.6c9.7,37.2,39.6,59,72.7,59c32.3-0.8,62.2-23.4,71.1-59c4-17,12.1-17.8,25.8-17.8c119.5,0,238.3,0.8,357.8,0c17,0,26.7,2.4,31.5,21.8c8.9,31.5,30.7,51.7,64.6,54.9c29.1,3.2,62.2-12.1,70.3-42.8c9.7-33.9,29.9-36.3,57.3-33.1c7.3,0.8,15.3,0,22.6,0c29.1,0,33.9-4.8,33.9-33.1C957.6,679.4,957.6,479.9,957.6,281.2z M220.1,941.1c-15.3-0.8-22.6-12.1-26.7-28.3H250C245.2,929.8,237.1,942.7,220.1,941.1z M781.5,941.1c-17,0.8-25-11.3-30.7-29.1h57.3C803.3,928.2,796,940.3,781.5,941.1z M911.5,864.4h-823v-571h823V864.4z M170.1,824.8c110.7,0,220.5,0,331.2,0s220.5,0,331.2,0c30.7,0,37.2-5.7,37.2-35.5c0-138.9-0.8-277.8-0.8-416.8c0-29.1-6.5-34.7-35.5-34.7c-221.3,0-442.6,0-663.9,0c-29.1,0-34.7,5.7-34.7,35.5c0,138.1-0.8,276.2-0.8,415.2C132.9,820,137.7,824.8,170.1,824.8z M182.2,387h636.5v389.3H182.2V387z M632.9,611.6c-15.3-0.8-24.2,8.1-26.7,22.6c-1.6,9.7-1.6,21-6.5,27.5c-8.1,9.7-21,22.6-31.5,21.8c-11.3,0-24.2-12.1-33.1-22.6c-5.7-6.5-5.7-17.8-7.3-27.5c-1.6-14.5-10.5-23.4-24.2-23.4c-14.5,0-23.4,8.9-25.8,24.2c-0.8,8.1,0,18.6-4.8,23.4c-9.7,10.5-21,23.4-33.9,25.8c-17,4-28.3-11.3-34.7-26.7c-3.2-8.1-1.6-19.4-5.7-25.8c-5.7-8.9-16.2-19.4-24.2-19.4c-8.1,0-22.6,12.1-23.4,20.2c-2.4,35.5,10.5,66.2,40.4,87.2c27.5,19.4,56.5,20.2,85.6,4.8c8.9-4.8,17-11.3,25-17.8c1.6,1.6,4,2.4,4.8,3.2c27.5,25,59.8,32.3,93.7,16.2c36.3-17.8,51.7-49.3,53.3-88.8C656.3,622.1,648.2,612.4,632.9,611.6z M764.5,545.3c-46.8-29.1-93.7-57.3-141.3-84.8c-12.1-7.3-25-3.2-32.3,9.7c-7.3,12.1-4.8,25,8.1,32.3c46,28.3,92.1,56.5,139.7,83.2c17.8,9.7,36.3-2.4,36.3-25.8C773.4,557.5,770.2,548.6,764.5,545.3z M389.7,488c-0.8-7.3-12.1-13.7-17-17.8c-7.3,0.8-9.7,0.8-11.3,1.6c-42.8,19.4-86.4,38-128.4,59.8c-6.5,3.2-10.5,20.2-8.1,29.9c3.2,13.7,17,17.8,29.9,12.1c42-18.6,84-37.2,125.2-58.2C386.5,512.2,391.4,496.9,389.7,488z"></path> </svg> </a></li><li><a href="http://i.youku.com/pythontutorial" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 1000 1000"> <g> <path d="M638.1,646.2h1.6l0.1-51.9h-11l-0.1,39C628.6,641.8,631.8,646.2,638.1,646.2z"></path> <path d="M559.1,684.6l80.5,0.1l0.1-17.1l-5.9-0.1c-16,0-28.7-12.6-28.6-28.6l0.1-44.6l-8.5,0v0.8c-0.1,36.7-9.3,67.6-18,78l-19.6-11.8L559.1,684.6z"></path> <path d="M596.9,535.9h8.4v30h-8.4V535.9z"></path> <path d="M559,729c0,5.3,0.7,9.2,2.9,11.5c2,2,4.9,2.9,9,2.9c0.3,0,12,0,25.6,0c1.7,0,3.5,0,5.2,0c13.6,0,25.4,0,25.7,0c4.1,0,7-0.9,9-2.9c2.3-2.3,3-6.2,3-11.4l0-17.5l-80.5-0.2L559,729z"></path> <path d="M348.9,373.3c21.2,0,38.6-21.9,38.6-48.7c0-26.9-17.2-48.9-38.5-48.9h0c-21.2,0-38.6,21.9-38.7,48.8c0,13,4,25.3,11.2,34.5C328.9,368.2,338.5,373.3,348.9,373.3z"></path> <path d="M573.2,594.9v-0.8l-13.9,0l-0.1,63.4l1.5-2.3C569.6,642.3,573.2,617.5,573.2,594.9z"></path> <path d="M892,10H108c-54.1,0-98,43.9-98,98v784c0,54.1,43.9,98,98,98h784c54.2,0,98-43.9,98-98V108C990,53.9,946.2,10,892,10z M595.9,264.4c0.9-16,8.4-23.4,23.3-23.4c14.6,0,23.3,8.4,23.7,23.5V311l61.3-62.5c3.7-3.7,10.8-7.4,18.2-7.4c6.1,0,11.5,2.4,16.1,7.2c16.9,17.5-1.7,37.1-2.5,37.9l-41.7,39.2l46.4,42.8c5.4,5,8.7,12.7,9,20.6c0.2,6.4-1.6,11.9-5.2,15.7c-4.1,4.1-10.2,6.5-16.9,6.5c-6.5,0-12.4-2.2-16.9-6.1c-3.4-3.2-66.2-61.1-66.2-61.1l-1.3-1.4v49.2c-0.7,14-8.7,21.1-23.5,21.1v0.9l0,0l-0.3-0.9c-14.8,0-22.5-6.9-23.3-21.2L595.9,264.4L595.9,264.4z M349.2,234c46.1,0.1,83.6,40.1,83.5,89.2c-0.1,54-33,88.9-83.7,88.9v0.9l-0.2-0.9c-24.7,0-45.8-9.1-61.1-26.1c-14.5-16.2-22.5-38.6-22.4-63C265.4,273.9,303,234,349.2,234z M438,502.7c26.9,19.6,48.9,37.8,52.7,41l-21.3,23.9c-4.3-4-32.7-29.9-49.5-43.3L438,502.7z M164.3,476.3c-3.6,0-7.6-0.9-11.8-2.8c-21-9-13.1-30.6-11.3-34.8l25.5-56.7L102,272c-0.4-0.9-11.8-23.3,8.1-35c4.3-2.5,8.6-3.8,12.9-3.8c11,0,19.4,8.6,23.6,16.6l44.9,77l33.5-74.6c3.7-9.3,9.1-18.9,21.3-18.9c3.9,0,8.3,0.9,13.2,2.9c6.4,2.4,10.7,6.4,13,11.6c4.2,10.1-0.8,21.8-0.8,21.9l-84,185.7C183,465.7,176.6,476.3,164.3,476.3z M499.8,735.9c-2.4,12.7-6.9,21.4-13.6,26.7c-6.2,5-15.3,7.4-28.6,7.4l-20,0c-6.5,0-11.5-0.6-16.6-2c-5-1.4-9.2-3.7-12.2-6.7c-3.1-2.8-5.5-6.8-7-11.9c-1.5-4.9-2-10.6-2-17.6l0.3-129.3h-6.9c-2.8,31.6-8.6,58.7-17.6,81.7c-11,28.4-29.7,57.4-58.7,87.6L292,752.3v19.5l-32.7-0.1l0.3-132.7c0,0-9.3,14.3-18.2,26.3l-24.6-22.7c30.3-41.5,53.3-86.6,69.2-142.3l31.1,12.3c-5.3,21.9-13.7,46.3-24.7,70.2L292,747.9c24.6-23.6,41.2-47.9,52.2-73.2c8.4-17.8,13.8-42,16.3-72.3l-55.9-0.1l0-28.9l56.6,0.1l0.1-73.1l32.8,0.1l-0.2,73.1l102.5,0.2l0,28.9l-63.7-0.2L432.3,729c0,11.2,6.6,13.7,12.3,13.7h7.3c5.1,0,9-1.2,11.6-3.7c2.8-2.5,4.3-6.3,4.9-11.8c1-6.6,3-28,3.8-40.8l32.5,9.7C503.4,706.4,501.3,726.8,499.8,735.9z M437.8,348.9v-83.3c0.8-17.2,8.3-25.6,22.8-25.6c13.5,0.6,20.6,9,21.4,25.6V349c0.9,18.2,13.1,29.9,31.3,30c17.5,0,30.3-12.3,31.2-29.9v-83.3c0.5-16.2,8.2-25,22-25.4c14,0.5,21.5,9.1,22.3,25.5v83.3c-2.2,42.2-27,63.1-75.8,63.9C464.6,412,439.3,390.5,437.8,348.9z M668.6,536.1l-39.7-0.1l0,30l39.3,0l-0.3,151.6h-0.1l0,24.2c0,11-2.4,18.2-7.6,22.3c-4.6,4.2-13.1,6.1-25.6,6.1l-32.7-0.1h-5.1l-32.7-0.1c-12.5,0-20.8-2-25.5-6.2c-5.2-4.1-7.6-11.4-7.5-22.4l0-24.2l0.3-151.6l42.1,0.1l0.1-30l-42.1-0.1l0-28.8h137.3L668.6,536.1z M806,742.2c0.1,11-2.4,18.3-7.6,22.4c-4.6,4.1-13.1,6.1-25.6,6.1h-15.3l-23.4-0.1h-15.3c-12.5,0-20.9-2.1-25.5-6.2c-5.2-4.1-7.7-11.4-7.5-22.4L686,652l120.1,0.3L806,742.2z M813.1,635.9l-135.3-0.3v-27.4l55,0.1l0.1-39l-26.9,0l-0.4,1.5c-2.5,12.7-6.1,25.6-6.7,28.5l-26.4-5.2c1.4-6.2,12.4-51.1,14-82.5l28.9,2.3c-0.8,9-2,18.2-3.7,27.4l-0.1,0.9l21.3,0.1l0.1-41.2l31.4,0.1l-0.1,41.2l40.4,0.1l-0.1,27l-40.4-0.1l0,38.9l49,0.1L813.1,635.9z M901.6,349.1c-2.2,42.2-27,63.1-75.8,63.9c-48.4-0.9-73.6-22.5-75.2-64.1v-83.3c0.9-17.2,8.3-25.6,22.9-25.6c13.5,0.6,20.6,9,21.4,25.6V349c0.8,18.2,13.1,29.9,31.2,30c17.5,0,30.3-12.3,31.2-29.9v-83.3c0.6-16.2,8.2-25,22-25.4c14,0.5,21.5,9.1,22.3,25.5V349.1z"></path> <path d="M729.1,743.6c0.1,0,2,0,5.1,0c9.6,0,18.2,0,23.4,0c3.1,0,5,0,5,0c4.1,0,7-0.9,9-2.9c2.4-2.3,3.1-6.1,3.1-11.4l0.1-50.2l-57.6-0.1l-0.1,50.2c0,5.3,0.7,9.2,3,11.4C722,742.6,725,743.6,729.1,743.6z"></path> </g> </svg> </a></li> <li><a href="https://www.zhihu.com/people/morvan/activities" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 24 24"> <path d="M5.721 0C2.251 0 0 2.25 0 5.719V18.28C0 21.751 2.252 24 5.721 24h12.56C21.751 24 24 21.75 24 18.281V5.72C24 2.249 21.75 0 18.281 0zm1.964 4.078c-.271.73-.5 1.434-.68 2.11h4.587c.545-.006.445 1.168.445 1.171H9.384a58.104 58.104 0 01-.112 3.797h2.712c.388.023.393 1.251.393 1.266H9.183a9.223 9.223 0 01-.408 2.102l.757-.604c.452.456 1.512 1.712 1.906 2.177.473.681.063 2.081.063 2.081l-2.794-3.382c-.653 2.518-1.845 3.607-1.845 3.607-.523.468-1.58.82-2.64.516 2.218-1.73 3.44-3.917 3.667-6.497H4.491c0-.015.197-1.243.806-1.266h2.71c.024-.32.086-3.254.086-3.797H6.598c-.136.406-.158.447-.268.753-.594 1.095-1.603 1.122-1.907 1.155.906-1.821 1.416-3.6 1.591-4.064.425-1.124 1.671-1.125 1.671-1.125zM13.078 6h6.377v11.33h-2.573l-2.184 1.373-.401-1.373h-1.219zm1.313 1.219v8.86h.623l.263.937 1.455-.938h1.456v-8.86z"></path> </svg> </a></li><li><a href="http://weibo.com/u/5945530751" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 32 32"> <path d="M21.938 6.281a6.314 6.314 0 0 0-1.625.125.93.93 0 0 0-.72 1.094.93.93 0 0 0 1.095.719c1.527-.324 3.19.136 4.312 1.375a4.552 4.552 0 0 1 .938 4.437c-.157.485.109 1 .593 1.156.48.157 1-.113 1.157-.593.671-2.09.265-4.473-1.313-6.219a6.395 6.395 0 0 0-4.438-2.094zm-8.282 2.75c-1.676.18-4.015 1.485-6.094 3.563C5.301 14.859 4 17.27 4 19.344c0 3.968 5.082 6.375 10.063 6.375 6.527 0 10.874-3.801 10.874-6.813 0-1.82-1.527-2.855-2.906-3.281-.34-.102-.582-.148-.406-.594.383-.965.445-1.812.031-2.406-.777-1.113-2.933-1.055-5.375-.031 0 0-.758.36-.562-.25.375-1.207.304-2.227-.281-2.813-.415-.414-1.02-.582-1.782-.5zm8.125.5a3.091 3.091 0 0 0-.781.063.827.827 0 0 0-.625.969.781.781 0 0 0 .938.593 1.568 1.568 0 0 1 1.468.469c.375.414.473.973.313 1.469a.794.794 0 0 0 .5 1 .793.793 0 0 0 1-.5 3.102 3.102 0 0 0-.657-3.031 3.1 3.1 0 0 0-2.156-1.032zm-7.187 5.281c3.32.118 5.992 1.782 6.219 4.063.257 2.61-2.747 5.047-6.72 5.438-3.972.39-7.429-1.422-7.687-4.032-.258-2.61 2.778-5.047 6.75-5.437.496-.051.965-.047 1.438-.031zM13.03 16.75c-1.437.137-2.789.969-3.406 2.219-.836 1.699-.035 3.601 1.875 4.218 1.98.637 4.313-.351 5.125-2.187.8-1.793-.2-3.621-2.156-4.125a4.162 4.162 0 0 0-1.438-.125zm.906 2.188a.36.36 0 0 1 .157.03c.242.09.351.356.219.595-.141.238-.446.347-.688.25-.238-.098-.32-.36-.188-.594a.613.613 0 0 1 .5-.282zm-1.843.562c.168.004.347.027.5.094.62.265.816.976.437 1.593-.383.614-1.191.907-1.812.625-.61-.277-.79-.996-.406-1.593.285-.446.78-.727 1.28-.719z"></path> </svg> </a></li> </ul> <br> <br> <p><b>Email:</b> mofanpy@hotmail.com</p> <p>© 2022 mofanpy.com All Rights Reserved <a href="http://beian.miit.gov.cn/" target="_blank">粤ICP备20060366号</a></p> </footer> <script>
  
  var _hmt = _hmt || [];
  (function () {
    let hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?9d4c4973d7eb0cd4876e83fa9b6005c9";
    let s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script> <script async="" src="./Double DQN _ 莫烦Python_files/js(1)"></script> <script>
  $(document).ready(function () {
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-108653085-2');
  })
</script>  <script type="text/javascript">
  $(document).ready(function () {
    (adsbygoogle = window.adsbygoogle || []).onload = function () {
      try {
        [].forEach.call(document.getElementsByClassName('adsbygoogle'), function () {
          adsbygoogle.push({})
        })
      } catch (a) {
        console.log(a)
      }
    }
  });
</script> <ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done" style="display: none !important;" data-ad-status="unfilled"><div id="aswift_0_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;border:0;width:undefinedpx;height:undefinedpx;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./Double DQN _ 莫烦Python_files/ads(4).html" data-google-container-id="a!1" data-load-complete="true"></iframe></div></ins><deepl-input-controller><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://cofdbpoegempjloogbagkncekinflcnj/build/content.css"><div><div class="dl-input-translation-container svelte-ju4595"><div></div></div></div></template></deepl-input-controller></body><iframe id="google_esf" name="google_esf" src="./Double DQN _ 莫烦Python_files/zrt_lookup.html" style="display: none;"></iframe></html>