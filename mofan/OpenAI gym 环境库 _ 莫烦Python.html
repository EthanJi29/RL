<!DOCTYPE html>
<!-- saved from url=(0073)https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym -->
<html lang="zh"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="title" content="OpenAI gym 环境库 | 莫烦Python"><meta name="description" content="手动编环境是一件很耗时间的事情, 所以如果有能力使用别人已经编好的环境, 可以节约我们很多时间. OpenAI gym 就是这样一个模块, 他提供了我们很多优秀的模拟环境. 我们的各种 RL 算法都能使用这些环境. 不过 OpenAI gym 暂时只支持 MacOS 和 Linux 系统. Windows 可能某一天就能支持了, 大家时不时查看下官网, 可能就有惊喜. 是在等不及更新了, 也行用 tkinter 来手动编写一下环境. 这里有我制作的很好的 tkinter 入门教程, 之前的 maze 环境也是用 tkinter 编出来的. 大家可以仿照这个文件编写就 ok 啦."><meta name="image" content="https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.4_openai.jpg"><meta name="keywords" content="莫烦,沫凡,周沫凡,周莫烦,周莫凡,python,tutorial,machine learning,OpenAI gym 环境库"><meta name="author" content="Mofan,Morvan,莫烦,周沫凡,周莫烦"><meta name="baidu-site-verification" content="qdybaXHfFg"><meta name="sogou_site_verification" content="zzqZtIRvnK"><meta name="msvalidate.01" content="A25A16143F8A52E0CC3FD76FE0E5F03B"><meta name="360-site-verification" content="2ab9df6f0a067733338a68c01294e730"><title>OpenAI gym 环境库 | 莫烦Python</title><meta property="fb:app_id" content="2053270218284962"><meta property="og:site_name" content="莫烦Python"><meta property="og:title" content="OpenAI gym 环境库 | 莫烦Python"><meta property="og:description" content="手动编环境是一件很耗时间的事情, 所以如果有能力使用别人已经编好的环境, 可以节约我们很多时间. OpenAI gym 就是这样一个模块, 他提供了我们很多优秀的模拟环境. 我们的各种 RL 算法都能使用这些环境. 不过 OpenAI gym 暂时只支持 MacOS 和 Linux 系统. Windows 可能某一天就能支持了, 大家时不时查看下官网, 可能就有惊喜. 是在等不及更新了, 也行用 tkinter 来手动编写一下环境. 这里有我制作的很好的 tkinter 入门教程, 之前的 maze 环境也是用 tkinter 编出来的. 大家可以仿照这个文件编写就 ok 啦."><meta property="og:image" content="https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.4_openai.jpg"><meta property="og:url" content="http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym"><meta property="og:type" content="article"><meta name="twitter:card" content="article"><meta name="twitter:site" content="http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym"><meta name="twitter:title" content="OpenAI gym 环境库 | 莫烦Python"><meta name="twitter:description" content="手动编环境是一件很耗时间的事情, 所以如果有能力使用别人已经编好的环境, 可以节约我们很多时间. OpenAI gym 就是这样一个模块, 他提供了我们很多优秀的模拟环境. 我们的各种 RL 算法都能使用这些环境. 不过 OpenAI gym 暂时只支持 MacOS 和 Linux 系统. Windows 可能某一天就能支持了, 大家时不时查看下官网, 可能就有惊喜. 是在等不及更新了, 也行用 tkinter 来手动编写一下环境. 这里有我制作的很好的 tkinter 入门教程, 之前的 maze 环境也是用 tkinter 编出来的. 大家可以仿照这个文件编写就 ok 啦."><meta name="twitter:creator" content="莫烦Python"><meta name="twitter:image" content="https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.4_openai.jpg"><link href="./OpenAI gym 环境库 _ 莫烦Python_files/page-style.min.css" type="text/css" rel="stylesheet"><script src="./OpenAI gym 环境库 _ 莫烦Python_files/f(5).txt"></script><script type="text/javascript" async="" src="./OpenAI gym 环境库 _ 莫烦Python_files/analytics.js"></script><script type="text/javascript" async="" src="./OpenAI gym 环境库 _ 莫烦Python_files/js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/f(6).txt" id="google_shimpl"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/hm.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/jquery-1.9.1.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/comment.min.js"></script><link rel="stylesheet" href="./OpenAI gym 环境库 _ 莫烦Python_files/gml.min.css"><script src="./OpenAI gym 环境库 _ 莫烦Python_files/highlight-10.5.0.min.js"></script><script type="text/javascript">hljs.initHighlightingOnLoad();</script><script type="text/javascript">
    
    $(window).bind('scroll load', function () {
      $.each($('.lazy-img'), function () {
        if ($(this).attr('data-src') &&
          $(this).offset().top < ($(window).scrollTop() + $(window).height() + 3000)) {
          var source = $(this).data('src');
          $(this).attr('src', source);
          $(this).removeAttr('data-src');
        }
      })
    })
  </script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/codemirror.min.js"></script><link rel="stylesheet" href="./OpenAI gym 环境库 _ 莫烦Python_files/codemirror.min.css"><link rel="stylesheet" href="./OpenAI gym 环境库 _ 莫烦Python_files/darcula.min.css"><link rel="stylesheet" href="./OpenAI gym 环境库 _ 莫烦Python_files/foldgutter.min.css"><link rel="stylesheet" href="./OpenAI gym 环境库 _ 莫烦Python_files/show-hint.min.css"><script src="./OpenAI gym 环境库 _ 莫烦Python_files/show-hint.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/python-hint.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/anyword-hint.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/python.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/sublime.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/active-line.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/foldcode.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/foldgutter.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/indent-fold.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/brace-fold.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/comment-fold.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/matchbrackets.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/closebrackets.min.js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/comment.min(1).js"></script><script src="./OpenAI gym 环境库 _ 莫烦Python_files/code.min.js"></script><link rel="stylesheet" href="./OpenAI gym 环境库 _ 莫烦Python_files/myCodeMirror.min.css"><script src="./OpenAI gym 环境库 _ 莫烦Python_files/pyodide.min.js"></script><script type="text/javascript">
  let dependencies, preCode;
  let onInteractivePage = false;
  let pyodideFullUrl = "";
  
  $(document).ready(function () {
    setCodeArea(onInteractivePage, dependencies, preCode, pyodideFullUrl)
  });
</script><meta http-equiv="origin-trial" content="A7CQXglZzTrThjGTBEn1rWTxHOEtkWivwzgea+NjyardrwlieSjVuyG44PkYgIPGs8Q9svD8sF3Yedn0BBBjXAkAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A3vKT9yxRPjmXN3DpIiz58f5JykcWHjUo/W7hvmtjgh9jPpQgem9VbADiNovG8NkO6mRmk70Kex8/KUqAYWVWAEAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A4A26Ymj79UVY7C7JGUS4BG1s7MdcDokAQf/RP0paks+RoTYbXHxceT/5L4iKcsleFCngi75YfNRGW2+SpVv1ggAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="As0hBNJ8h++fNYlkq8cTye2qDLyom8NddByiVytXGGD0YVE+2CEuTCpqXMDxdhOMILKoaiaYifwEvCRlJ/9GcQ8AAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="AgRYsXo24ypxC89CJanC+JgEmraCCBebKl8ZmG7Tj5oJNx0cmH0NtNRZs3NB5ubhpbX/bIt7l2zJOSyO64NGmwMAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A7CQXglZzTrThjGTBEn1rWTxHOEtkWivwzgea+NjyardrwlieSjVuyG44PkYgIPGs8Q9svD8sF3Yedn0BBBjXAkAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A3vKT9yxRPjmXN3DpIiz58f5JykcWHjUo/W7hvmtjgh9jPpQgem9VbADiNovG8NkO6mRmk70Kex8/KUqAYWVWAEAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A4A26Ymj79UVY7C7JGUS4BG1s7MdcDokAQf/RP0paks+RoTYbXHxceT/5L4iKcsleFCngi75YfNRGW2+SpVv1ggAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="As0hBNJ8h++fNYlkq8cTye2qDLyom8NddByiVytXGGD0YVE+2CEuTCpqXMDxdhOMILKoaiaYifwEvCRlJ/9GcQ8AAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="AgRYsXo24ypxC89CJanC+JgEmraCCBebKl8ZmG7Tj5oJNx0cmH0NtNRZs3NB5ubhpbX/bIt7l2zJOSyO64NGmwMAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A7CQXglZzTrThjGTBEn1rWTxHOEtkWivwzgea+NjyardrwlieSjVuyG44PkYgIPGs8Q9svD8sF3Yedn0BBBjXAkAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A3vKT9yxRPjmXN3DpIiz58f5JykcWHjUo/W7hvmtjgh9jPpQgem9VbADiNovG8NkO6mRmk70Kex8/KUqAYWVWAEAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A4A26Ymj79UVY7C7JGUS4BG1s7MdcDokAQf/RP0paks+RoTYbXHxceT/5L4iKcsleFCngi75YfNRGW2+SpVv1ggAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="As0hBNJ8h++fNYlkq8cTye2qDLyom8NddByiVytXGGD0YVE+2CEuTCpqXMDxdhOMILKoaiaYifwEvCRlJ/9GcQ8AAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="AgRYsXo24ypxC89CJanC+JgEmraCCBebKl8ZmG7Tj5oJNx0cmH0NtNRZs3NB5ubhpbX/bIt7l2zJOSyO64NGmwMAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A7CQXglZzTrThjGTBEn1rWTxHOEtkWivwzgea+NjyardrwlieSjVuyG44PkYgIPGs8Q9svD8sF3Yedn0BBBjXAkAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A3vKT9yxRPjmXN3DpIiz58f5JykcWHjUo/W7hvmtjgh9jPpQgem9VbADiNovG8NkO6mRmk70Kex8/KUqAYWVWAEAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A4A26Ymj79UVY7C7JGUS4BG1s7MdcDokAQf/RP0paks+RoTYbXHxceT/5L4iKcsleFCngi75YfNRGW2+SpVv1ggAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="As0hBNJ8h++fNYlkq8cTye2qDLyom8NddByiVytXGGD0YVE+2CEuTCpqXMDxdhOMILKoaiaYifwEvCRlJ/9GcQ8AAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="AgRYsXo24ypxC89CJanC+JgEmraCCBebKl8ZmG7Tj5oJNx0cmH0NtNRZs3NB5ubhpbX/bIt7l2zJOSyO64NGmwMAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3MTk1MzI3OTksImlzU3ViZG9tYWluIjp0cnVlfQ=="></head>                        <body class="vsc-initialized"> <a href="./OpenAI gym 环境库 _ 莫烦Python_files/4.4_openai.jpg"><img alt="OpenAI gym 环境库" src="./OpenAI gym 环境库 _ 莫烦Python_files/4.4_openai.jpg" style="display: none"></a> <header> <nav id="home-nav"> <ul> <li id="liHome"><a class="nav-home bold" href="https://mofanpy.com/">莫烦PYTHON</a></li> <li id="liStudy" class="dropbtn"><a class="navClicker">学习 ▾</a> <ul class="dropdown-content" style="display: none"> <li class="dropbtn"> <a class="" href="https://mofanpy.com/learning-steps/"> <img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/learning-steps.png" alt="推荐学习顺序">推荐学习顺序</a> </li> <li class="dropbtn"> <a class="navClicker" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym"> <img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/python_icon.png" alt="Python基础 ▾">Python基础 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/basic_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="交互式学Python"> <a href="https://mofanpy.com/tutorials/python-basic/interactive-python/">交互式学Python </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/multiprocessing_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="多进程 multiprocessing"> <a href="https://mofanpy.com/tutorials/python-basic/multiprocessing/">多进程 multiprocessing </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/thread_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="多线程 threading"> <a href="https://mofanpy.com/tutorials/python-basic/threading/">多线程 threading </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/GUI_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="窗口视窗 Tkinter"> <a href="https://mofanpy.com/tutorials/python-basic/tkinter/">窗口视窗 Tkinter </a></li> </ul> </li> <li class="dropbtn"> <a class="navClicker" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym"> <img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/ML_icon.png" alt="机器学习 ▾">机器学习 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/ML_intro_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="有趣的机器学习"> <a href="https://mofanpy.com/tutorials/machine-learning/ML-intro/">有趣的机器学习 </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/rl_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="强化学习 Reinforcement Learning"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/">强化学习 Reinforcement Learning </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/evolution_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="进化算法 Evolutionary Algorithm"> <a href="https://mofanpy.com/tutorials/machine-learning/evolutionary-algorithm/">进化算法 Evolutionary Algorithm </a></li> <li class="dropbtn"><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/neural_net_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="神经网络 ▾"> <a class="navClicker">神经网络 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/tf_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="Tensorflow"> <a href="https://mofanpy.com/tutorials/machine-learning/tensorflow/">Tensorflow</a> </li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/torch_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="PyTorch"> <a href="https://mofanpy.com/tutorials/machine-learning/torch/">PyTorch</a> </li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/theano_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="Theano"> <a href="https://mofanpy.com/tutorials/machine-learning/theano/">Theano</a> </li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/keras_icon.jpg" style="max-width:1.5em; max-height:1.1em;" alt="Keras"> <a href="https://mofanpy.com/tutorials/machine-learning/keras/">Keras</a> </li> </ul> </li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/sklearn_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="通用机器学习 Scikit-learn"> <a href="https://mofanpy.com/tutorials/machine-learning/sklearn/">通用机器学习 Scikit-learn </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/nlp_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="自然语言处理"> <a href="https://mofanpy.com/tutorials/machine-learning/nlp/">自然语言处理 </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/gan_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="生成对抗网络"> <a href="https://mofanpy.com/tutorials/machine-learning/gan/">生成对抗网络 </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/ML-practice_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="机器学习实战"> <a href="https://mofanpy.com/tutorials/machine-learning/ML-practice/">机器学习实战 </a></li> </ul> </li> <li class="dropbtn"> <a class="navClicker" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym"> <img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/data_icon.png" alt="数据处理 ▾">数据处理 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/numpy.svg" style="max-width:1.5em; max-height:1.1em;" alt="Numpy 数据怪兽"> <a href="https://mofanpy.com/tutorials/data-manipulation/numpy/">Numpy 数据怪兽 </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/pandas.svg" style="max-width:1.5em; max-height:1.1em;" alt="Pandas 数据伙伴"> <a href="https://mofanpy.com/tutorials/data-manipulation/pandas/">Pandas 数据伙伴 </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/plt_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="画图 Matplotlib"> <a href="https://mofanpy.com/tutorials/data-manipulation/plt/">画图 Matplotlib </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/scraping_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="网页爬虫"> <a href="https://mofanpy.com/tutorials/data-manipulation/scraping/">网页爬虫 </a></li> </ul> </li> <li class="dropbtn"> <a class="navClicker" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym"> <img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/others_icon.png" alt="提效工具 ▾">提效工具 ▾</a> <ul class="dropdown-content"> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/git_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="Git 版本管理"> <a href="https://mofanpy.com/tutorials/others/git/">Git 版本管理 </a></li> <li><img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/linux_icon.png" style="max-width:1.5em; max-height:1.1em;" alt="Linux 简易教学"> <a href="https://mofanpy.com/tutorials/others/linux-basic/">Linux 简易教学 </a></li> </ul> </li> <li class="dropbtn"> <a class="" href="https://mofanpy.com/minipy/"> <img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/minipy_icon.svg" alt="MiniPy 小程序">MiniPy 小程序</a> </li> <li class="dropbtn"> <a class="" href="https://mofanpy.com/rethink/"> <img class="icon-image" src="./OpenAI gym 环境库 _ 莫烦Python_files/rethink.png" alt="Rethink">Rethink</a> </li> </ul> </li> <li id="liDiscuss"><a href="https://mofanpy.com/discuss">大家说</a></li> <li id="liMinipy"><a href="https://mofanpy.com/minipy/">MiniPy</a></li> <li id="liAbout" class="mobile-hid"><a href="https://mofanpy.com/about">About</a></li> <li id="liSupport"><a href="https://mofanpy.com/support">赞助</a></li> <li id="liSearch" class="mobile-hid"> <a class="search-bar navClicker"><img class="search-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/search_icon.png" alt="Go"></a> <form class="search-box dropdown-content" method="get" action="https://www.baidu.com/s" target="_blank"> <input type="hidden" name="q6" value="mofanpy.com"> <input type="hidden" name="tn" value="baiduadv"> <input class="search-text" type="text" name="q3" placeholder="Search.." size="20" value=""> </form> </li> <li id="liNotification" class="nav-notification nav-float-right"> <a id="nav-img-a" href="https://mofanpy.com/login">登录</a></li> </ul> </nav> <script type="text/javascript" async="">
    $(document).ready(function () {
      $('.navClicker').on("click", function (e) {
        $(this).next('.dropdown-content').toggle();
        e.stopPropagation();
        e.preventDefault();
      });
    });

    if ('False' === "True") {
      const aLink = $("#liNotification").children().first();
      aLink.empty();
      aLink.attr("id", "nav-img-a");
      aLink.attr("href", "/user/");
      aLink.append($("<img>", {
        id: "nav-img",
          src: "/static/img/icon/default_user_icon.png",
          alt: ""
      }));

      let navNoti = $(".nav-notification");
      navNoti.css({display: "inline-block"}).append(aLink);
      navNoti.html(navNoti.html());
      checkCommentResponse('https://mofanpy.com/api/comment');
    }

    function isOnMobile() {
      let check = false;
      (function (a) {
        if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true;
      })(navigator.userAgent || navigator.vendor || window.opera);
      if (navigator.userAgentData) {
        if (navigator.userAgentData.mobile) {
          check = true;
        }
      }
      return check;
    }


  </script> </header> <main class="tut-main"> <div id="left-side-share-donate"> <ul> <li> <a href="https://www.facebook.com/sharer/sharer.php?u=http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym&amp;pic=https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.4_openai.jpg" target="_blank"> <svg class="left-share-link" viewBox="0 0 1024 1024"> <path d="M1024,512C1024,229.23016,794.76978,0,512,0S0,229.23016,0,512c0,255.554,187.231,467.37012,432,505.77777V660H302V512H432V399.2C432,270.87982,508.43854,200,625.38922,200,681.40765,200,740,210,740,210V336H675.43713C611.83508,336,592,375.46667,592,415.95728V512H734L711.3,660H592v357.77777C836.769,979.37012,1024,767.554,1024,512Z" fill-rule="evenodd"></path> </svg> </a> </li> <li> <a href="https://service.weibo.com/share/share.php?url=http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym&amp;type=icon&amp;language=zh_cn&amp;searchPic=true&amp;title=OpenAI%20gym%20%E7%8E%AF%E5%A2%83%E5%BA%93&amp;pic=https://static.mofanpy.com/static/img/thumbnail-small/reinforcement-learning/4.4_openai.jpg" target="_blank"> <svg class="left-share-link" viewBox="0 0 97.75 97.75"> <path d="M48.875,0C21.883,0,0,21.883,0,48.875S21.883,97.75,48.875,97.75S97.75,75.867,97.75,48.875S75.867,0,48.875,0z
                 M43.332,76.779c-14.294,0-28.904-6.928-28.904-18.32c0-5.957,3.773-12.844,10.271-19.344c8.68-8.674,18.799-12.627,22.604-8.818
                c1.679,1.678,1.841,4.582,0.763,8.051c-0.563,1.748,1.639,0.779,1.639,0.783c7.016-2.938,13.135-3.109,15.37,0.086
                c1.192,1.703,1.079,4.09-0.021,6.859c-0.509,1.273,0.157,1.473,1.127,1.762c3.952,1.227,8.351,4.189,8.351,9.412
                C74.531,65.893,62.068,76.779,43.332,76.779z M69.206,40.553c0.463-1.428,0.172-3.055-0.905-4.25
                c-1.076-1.191-2.668-1.645-4.136-1.334v-0.002c-1.224,0.266-2.431-0.52-2.69-1.742c-0.266-1.229,0.518-2.436,1.744-2.697
                c3.002-0.637,6.254,0.291,8.455,2.732c2.208,2.443,2.797,5.771,1.854,8.689c-0.385,1.195-1.664,1.846-2.857,1.465
                c-1.193-0.389-1.846-1.67-1.461-2.861H69.206z M82.438,44.828c0,0.002,0,0.008,0,0.01c-0.449,1.383-1.937,2.141-3.321,1.693
                c-1.39-0.447-2.148-1.932-1.699-3.32l-0.001-0.004c1.377-4.26,0.504-9.119-2.71-12.682c-3.218-3.563-7.96-4.926-12.343-3.994
                c-1.426,0.305-2.826-0.605-3.131-2.029s0.604-2.826,2.029-3.131h0.002c6.16-1.309,12.834,0.602,17.357,5.619
                C83.148,32,84.37,38.832,82.438,44.828z"></path> <path d="M43.444,57.424c-0.678-0.27-1.526,0.057-1.924,0.723c-0.386,0.672-0.173,1.435,0.507,1.713
                c0.69,0.285,1.573-0.043,1.972-0.727C44.38,58.447,44.133,57.676,43.444,57.424z"></path> <path d="M40.688,45.58c-11.402,1.129-20.051,8.111-19.311,15.598c0.741,7.488,10.588,12.643,21.991,11.518
                c11.405-1.127,20.05-8.11,19.312-15.602C61.939,49.607,52.096,44.451,40.688,45.58z M50.695,63.24
                c-2.327,5.264-9.021,8.07-14.702,6.24c-5.482-1.771-7.803-7.187-5.402-12.063c2.356-4.783,8.492-7.487,13.918-6.074
                C50.126,52.795,52.992,58.094,50.695,63.24z"></path> <path d="M39.091,59.229c-1.767-0.739-4.049,0.021-5.138,1.73c-1.104,1.715-0.587,3.76,1.167,4.559
                c1.779,0.813,4.141,0.041,5.244-1.719C41.448,62.02,40.876,59.99,39.091,59.229z"></path> </svg> </a> </li> <li> <a href="https://static.mofanpy.com/static/qr/tutorials/machine-learning/reinforcement-learning/gym_deploy.png" target="_blank"> <svg class="left-share-link" viewBox="0 0 24 24"> <path d="M12 0c-6.626 0-12 5.372-12 12 0 6.627 5.374 12 12 12 6.627 0 12-5.373 12-12 0-6.628-5.373-12-12-12zm5.543 16.389c.889-.644 1.457-1.597 1.457-2.656 0-1.94-1.888-3.514-4.217-3.514-2.329 0-4.217 1.574-4.217 3.514 0 1.941 1.888 3.514 4.217 3.514.481 0 .946-.068 1.377-.192l.124-.019c.081 0 .154.025.224.065l.923.533.081.026c.078 0 .14-.063.14-.14l-.022-.103-.19-.709-.015-.09c0-.094.047-.178.118-.229zm-7.483-10.049c-2.794 0-5.06 1.888-5.06 4.217 0 1.27.682 2.414 1.748 3.187.086.061.142.161.142.275l-.018.107-.228.851-.027.123c0 .093.076.169.169.169l.097-.032 1.108-.639c.083-.048.172-.078.269-.078l.149.022c.516.149 1.074.231 1.651.231l.278-.006c-.11-.329-.17-.675-.17-1.034 0-2.123 2.066-3.845 4.615-3.845l.275.007c-.381-2.015-2.473-3.555-4.998-3.555zm3.317 6.831c-.31 0-.562-.252-.562-.562 0-.311.252-.562.562-.562.311 0 .563.251.563.562 0 .31-.252.562-.563.562zm2.812 0c-.311 0-.562-.252-.562-.562 0-.311.251-.562.562-.562.31 0 .562.251.562.562 0 .31-.252.562-.562.562zm-7.815-3.289c-.373 0-.675-.302-.675-.675 0-.372.302-.674.675-.674.372 0 .674.302.674.674 0 .373-.302.675-.674.675zm3.373 0c-.373 0-.675-.302-.675-.675 0-.372.302-.674.675-.674.373 0 .675.302.675.674 0 .373-.302.675-.675.675z" fill-rule="evenodd"></path> </svg> </a> </li> <li> <a href="https://twitter.com/intent/tweet?url=http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym&amp;original_referer=http://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym" target="_blank"> <svg class="left-share-link" viewBox="0 0 24 24"> <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z" fill-rule="evenodd"></path> </svg> </a> </li> <li> <a id="left-donation" href="https://mofanpy.com/support"> <p class="left-donation-text">支持</p> <div> <img src="./OpenAI gym 环境库 _ 莫烦Python_files/Wechat1.png"> <img src="./OpenAI gym 环境库 _ 莫烦Python_files/alipay.png"> </div> </a> </li> </ul> </div> <div class="tut-post-main"> <div class="section ie-size"> <a href="https://mofanpy.com/tutorials/data-manipulation/pandas/"> <div class="marquee"><p>【新】在线运行 Pandas 学习数据管理</p></div> </a> <a href="https://mofanpy.com/tutorials/python-basic/interactive-python/"> <div class="marquee"><p>【浏览器跑Python】交互式Python学习</p></div> </a> <a href="https://mofanpy.com/minipy/"> <div class="marquee"><p>【MiniPy】分享你的 Python 小程序</p></div> </a> </div> <div class="section ie-size" id="top-a-d-s"> <script async="" src="./OpenAI gym 环境库 _ 莫烦Python_files/f(7).txt" crossorigin="anonymous" data-checked-head="true"></script> <ins class="adsbygoogle" style="display:inline-block;width:700px;height:90px" data-ad-client="ca-pub-4601203457616636" data-ad-slot="6002797349" data-adsbygoogle-status="done" data-ad-status="filled"><div id="aswift_1_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 90px; width: 700px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;border:0;width:700px;height:90px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="700" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./OpenAI gym 环境库 _ 莫烦Python_files/ads.html" data-google-container-id="a!2" data-google-query-id="CMzgz92Hx4ADFZUGKgodxnYPug" data-load-complete="true"></iframe></div></ins> </div> <div class="section ie-size"> <script src="./OpenAI gym 环境库 _ 莫烦Python_files/video-select.min.js"></script> <div id="videogfw" class="video-container videogfw-bilibili"> <script type="text/javascript" async="">
      var bilibili_src = "//player.bilibili.com/player.html?aid=16921335&cid=27657253&page=18&high_quality=1&danmaku=0&as_wide=1";
      var youtube_src = "//www.youtube.com/embed/9m3DN2dyi8I";
      const youku_src = "//player.youku.com/embed/XMjUzMjA1NjY2NA==";
      if (window.innerWidth > 800) {
        youtube_src += "?autoplay=1&mute=1";
        
      }
      getEmbeddedVideo(bilibili_src, "av16921335?p=18", youtube_src, "9m3DN2dyi8I", youku_src, "XMjUzMjA1NjY2NA");

      if (!isOnMobile()) {
        moveVideo();
      }

    </script> <iframe id="myVideo" src="./OpenAI gym 环境库 _ 莫烦Python_files/player.html" frameborder="0" scrolling="no" allow="autoplay" framespacing="0" allowfullscreen="" autoplay="autoplay" width="100%"></iframe></div> <div class="switch-video-div"> <span style="font-weight: bold;vertical-align: super;">切换视频源：</span> <button class="switch-video-btn" onclick="chooseVideo(youtube_src, &#39;youtube&#39;, &#39;9m3DN2dyi8I&#39;)"> <img class="icon" src="./OpenAI gym 环境库 _ 莫烦Python_files/youtube.png" alt="Youtube频道"> </button> <button class="switch-video-btn" onclick="chooseVideo(bilibili_src, &#39;bilibili&#39;, &#39;
        av16921335?p=18&#39;)"> <img class="icon" src="./OpenAI gym 环境库 _ 莫烦Python_files/bilibili_icon.png" alt="Bilibili"> </button> <button class="switch-video-btn" onclick="chooseVideo(youku_src, &#39;youku&#39;, &#39;XMjUzMjA1NjY2NA&#39;)"> <img class="icon" src="./OpenAI gym 环境库 _ 莫烦Python_files/youku.jpg" alt="优酷频道"> </button> <p id="video-alrt-info" style="display: block; font-size: 0.8em; text-align: center;">(无法播放? 请 <a href="https://www.bilibili.com/video/av16921335?p=18" target="_blank">点击这里</a> 跳转至B站内)</p> <hr style="width: 60%;"> </div> <div class="pad-page-navigation"> <div class="PageNavigation"> <a class="prev" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN3"> <b>«</b> DQN 思维决策</a> <a class="next" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN"> Double DQN <b>»</b></a> </div> </div> </div> <div class="section ie-size"> <div class="tut-main-content-pad"> <br> <p class="course-title">OpenAI gym 环境库</p> <div style="text-align: center;color: #646464; font-size: 15px;"> 作者: <span class="author"> 莫烦 </span> 编辑: <span class="editor"> 莫烦 </span> 发布于: <span class="publish-date"> 2017-02-26 </span> </div> <div class="section ie-size" id="under-title-a-d-s"> <script async="" src="./OpenAI gym 环境库 _ 莫烦Python_files/f(7).txt" crossorigin="anonymous" data-checked-head="true"></script> <ins class="adsbygoogle" style="display:inline-block;width:250px;height:250px" data-ad-client="ca-pub-4601203457616636" data-ad-slot="2975922481" data-adsbygoogle-status="done" data-ad-status="filled"><div id="aswift_2_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 250px; width: 250px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;border:0;width:250px;height:250px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="250" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./OpenAI gym 环境库 _ 莫烦Python_files/ads(1).html" data-google-container-id="a!3" data-google-query-id="CPPv0t2Hx4ADFQ0FKgodDcUFIg" data-load-complete="true"></iframe></div></ins> </div> <p>学习资料:</p> <ul> <li><a href="https://github.com/MorvanZhou/Reinforcement-learning-with-tensorflow/tree/master/contents/6_OpenAI_gym" target="_blank">全部代码</a></li> <li><a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-DQN">什么是 DQN 短视频</a></li> <li><a href="https://gym.openai.com/envs/" target="_blank">OpenAI gym 官网</a></li> <li>本节内容的模拟视频效果: <ul> <li>CartPole: <a href="https://www.youtube.com/watch?v=qlqqezju0xo" target="_blank">Youtube</a>, <a href="https://www.youtube.com/watch?v=qlqqezju0xo" target="_blank">Youtube</a></li> <li>Mountain Car: <a href="https://www.youtube.com/watch?v=r1mNIDN3zNM" target="_blank">Youtube</a>, <a href="https://www.youtube.com/watch?v=r1mNIDN3zNM" target="_blank">Youtube</a></li> </ul></li> </ul> <h1 class="tut-h1-pad" id="要点">要点<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym#%E8%A6%81%E7%82%B9" class="headerlink" title="Permalink to this headline">¶</a></h1> <p>手动编环境是一件很耗时间的事情, 所以如果有能力使用别人已经编好的环境, 可以节约我们很多时间. OpenAI gym 就是这样一个模块, 他提供了我们很多优秀的模拟环境. 我们的各种 RL 算法都能使用这些环境. 不过 OpenAI gym 暂时只支持 MacOS 和 Linux 系统. Windows 已经支持, 但是听说还没有全面支持, 大家时不时查看下官网, 可能就有惊喜. 是在等不及更新了, 也行用 tkinter 来手动编写一下环境. 这里有我制作的很好的 <a href="https://mofanpy.com/tutorials/python-basic/tkinter">tkinter 入门教程</a>, 之前的 maze 环境也是用 tkinter 编出来的. 大家可以仿照<a href="https://github.com/MorvanZhou/Reinforcement-learning-with-tensorflow/blob/master/contents/5_Deep_Q_Network/maze_env.py" target="_blank">这个文件</a>编写就 ok 啦. 或者还可以玩玩更厉害的, 想 OpenAI 一样, 使用 pyglet 模块来编写, 我做了一个从环境开始编写的<a href="https://mofanpy.com/tutorials/machine-learning/ML-practice/RL-build-arm-from-scratch1">强化学习实战</a>.</p> <h1 class="tut-h1-pad" id="安装 gym">安装 gym<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym#%E5%AE%89%E8%A3%85%20gym" class="headerlink" title="Permalink to this headline">¶</a></h1> <p>在 MacOS 和 Linux 系统下, 安装 gym 很方便, 首先确定你是 python 2.7 或者 python 3.5 版本. 然后在你的 terminal 中复制下面这些. 但是 gym 暂时还不完全支持 Windows, 不过有些虚拟环境已经的到了支持, 想立杆子那个已经支持了. 所以接下来要说的安装方法只有 MacOS 和 Linux 的. Windows 用户的安装方式应该也差不多, 如果 Windows 用户遇到了问题, 欢迎在留言区分享解决的方法.</p> <pre><code class="shell hljs"><span class="hljs-meta">#</span><span class="bash"> python 2.7, 复制下面</span>
<span class="hljs-meta">$</span><span class="bash"> pip install gym</span>
<span class="hljs-meta">
#</span><span class="bash"> python 3.5, 复制下面</span>
<span class="hljs-meta">$</span><span class="bash"> pip3 install gym</span>
</code></pre> <p>如果没有报错, 恭喜你, 这样你就装好了 gym 的最基本款, 可以开始玩以下游戏啦:</p> <ul> <li><a href="https://gym.openai.com/envs#algorithmic" target="_blank">algorithmic</a></li> <li><a href="https://gym.openai.com/envs#toy_text" target="_blank">toy_text</a></li> <li><a href="https://gym.openai.com/envs#classic_control" target="_blank">classic_control</a> (这个需要 pyglet 模块)</li> </ul> <p>如果在安装中遇到问题. 可能是缺少了一些必要模块, 可以使用下面语句来安装这些模块(安装时间可能有点久):</p> <pre><code class="shell hljs"><span class="hljs-meta">#</span><span class="bash"> MacOS:</span>
<span class="hljs-meta">$</span><span class="bash"> brew install cmake boost boost-python sdl2 swig wget</span>
<span class="hljs-meta">
#</span><span class="bash"> Ubuntu 14.04:</span>
<span class="hljs-meta">$</span><span class="bash"> apt-get install -y python-numpy python-dev cmake zlib1g-dev libjpeg-dev xvfb libav-tools xorg-dev python-opengl libboost-all-dev libsdl2-dev swig</span>
</code></pre> <p>如果想要玩 gym 提供的全套游戏, 下面这几句就能满足你:</p> <pre><code class="shell hljs"><span class="hljs-meta">#</span><span class="bash"> python 2.7, 复制下面</span>
<span class="hljs-meta">$</span><span class="bash"> pip install gym[all]</span>
<span class="hljs-meta">
#</span><span class="bash"> python 3.5, 复制下面</span>
<span class="hljs-meta">$</span><span class="bash"> pip3 install gym[all]</span>
</code></pre><h1 class="tut-h1-pad" id="CartPole 例子">CartPole 例子<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym#CartPole%20%E4%BE%8B%E5%AD%90" class="headerlink" title="Permalink to this headline">¶</a></h1> <p><div class="vsc-controller"><template shadowrootmode="open">
        <style>
          @import "chrome-extension://nffaoalbilbmmfgbnbgppjihopabppdk/shadow.css";
        </style>

        <div id="controller" style="top:3054.84375px; left:231.3984375px; opacity:0.3">
          <span data-action="drag" class="draggable">1.00</span>
          <span id="controls">
            <button data-action="rewind" class="rw">«</button>
            <button data-action="slower">−</button>
            <button data-action="faster">+</button>
            <button data-action="advance" class="rw">»</button>
            <button data-action="display" class="hideButton">×</button>
          </span>
        </div>
      </template></div><video class="tut-content-video" controls="" loop="" autoplay="" muted=""> <source src="https://static.mofanpy.com/static/results/reinforcement-learning/cartpole%20dqn.mp4" type="video/mp4"> Your browser does not support HTML5 video. </video></p> <p>之前我编写的 <code>maze_env</code> 基本上是按照 <code>gym</code> 环境格式写的, 所以你换成 <code>gym</code> 格式会很简单.</p> <p>接下来我们对应上面的算法, 来实现主循环. 首先 import 所需模块.</p> <div><textarea class="scriptInput" style="display: none;">import gym
from RL_brain import DeepQNetwork

env = gym.make('CartPole-v0')   # 定义使用 gym 库中的那一个环境
env = env.unwrapped # 不做这个会有很多限制

print(env.action_space) # 查看这个环境中可用的 action 有多少个
print(env.observation_space)    # 查看这个环境中可用的 state 的 observation 有多少个
print(env.observation_space.high)   # 查看 observation 最高取值
print(env.observation_space.low)    # 查看 observation 最低取值
</textarea><div class="CodeMirror cm-s-darcula" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; min-height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 39px;"><div style="height: 100%; min-height: 1px; width: 658px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: -15px; border-right-width: 35px; min-height: 217px; min-width: 657.797px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">gym</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">RL_brain</span> <span class="cm-keyword">import</span> <span class="cm-variable">DeepQNetwork</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">env</span> <span class="cm-operator">=</span> <span class="cm-variable">gym</span>.<span class="cm-property">make</span>(<span class="cm-string">'CartPole-v0'</span>)   <span class="cm-comment"># 定义使用 gym 库中的那一个环境</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">env</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-property">unwrapped</span> <span class="cm-comment"># 不做这个会有很多限制</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">env</span>.<span class="cm-property">action_space</span>) <span class="cm-comment"># 查看这个环境中可用的 action 有多少个</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">env</span>.<span class="cm-property">observation_space</span>)    <span class="cm-comment"># 查看这个环境中可用的 state 的 observation 有多少个</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">env</span>.<span class="cm-property">observation_space</span>.<span class="cm-property">high</span>)   <span class="cm-comment"># 查看 observation 最高取值</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">env</span>.<span class="cm-property">observation_space</span>.<span class="cm-property">low</span>)    <span class="cm-comment"># 查看 observation 最低取值</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 217px;"></div><div class="CodeMirror-gutters" style="height: 267px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div><div class="CodeMirror-gutter CodeMirror-foldgutter"></div><div class="CodeMirror-gutter CodeMirror-lint-markers"></div></div></div></div> <div> <button class="userSubmitBtn scriptRunBtn" onclick="evaluatePython(this);" disabled="" id="scriptRunBtn-0"></button> <button class="userSubmitBtn scriptAddBtn" onclick="addCodeArea(this);" disabled="" id="scriptAddBtn-0"></button> </div> <div class="scriptOutput" id="scriptOutput-0"></div> <img src="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym" class="scriptImage" id="scriptImage-0"></div> <p>于之前使用 tkinter 定义的环境有点不一样, 我们可以不适用 <code>if __name__ == "__main__"</code> 的方式, 下面是一种类似, 却更简单的写法. 之中我们会用到里面的 reward, 但是 <code>env.step()</code> 说提供的 <code>reward</code> 不一定是最有效率的 <code>reward</code>, 我们大可对这些进行修改, 使 DQN 学得更有效率. 你可以自己对比一下不修改 reward 和 按我这样修改, 他们学习过程的不同.</p> <div><textarea class="scriptInput" style="display: none;"># 定义使用 DQN 的算法
RL = DeepQNetwork(n_actions=env.action_space.n,
                  n_features=env.observation_space.shape[0],
                  learning_rate=0.01, e_greedy=0.9,
                  replace_target_iter=100, memory_size=2000,
                  e_greedy_increment=0.0008,)

total_steps = 0 # 记录步数

for i_episode in range(100):

    # 获取回合 i_episode 第一个 observation
    observation = env.reset()
    ep_r = 0
    while True:
        env.render()    # 刷新环境

        action = RL.choose_action(observation)  # 选行为

        observation_, reward, done, info = env.step(action) # 获取下一个 state

        x, x_dot, theta, theta_dot = observation_   # 细分开, 为了修改原配的 reward

        # x 是车的水平位移, 所以 r1 是车越偏离中心, 分越少
        # theta 是棒子离垂直的角度, 角度越大, 越不垂直. 所以 r2 是棒越垂直, 分越高

        x, x_dot, theta, theta_dot = observation_
        r1 = (env.x_threshold - abs(x))/env.x_threshold - 0.8
        r2 = (env.theta_threshold_radians - abs(theta))/env.theta_threshold_radians - 0.5
        reward = r1 + r2   # 总 reward 是 r1 和 r2 的结合, 既考虑位置, 也考虑角度, 这样 DQN 学习更有效率

        # 保存这一组记忆
        RL.store_transition(observation, action, reward, observation_)

        if total_steps &gt; 1000:
            RL.learn()  # 学习

        ep_r += reward
        if done:
            print('episode: ', i_episode,
                  'ep_r: ', round(ep_r, 2),
                  ' epsilon: ', round(RL.epsilon, 2))
            break

        observation = observation_
        total_steps += 1
# 最后输出 cost 曲线
RL.plot_cost()
</textarea><div class="CodeMirror cm-s-darcula" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; min-height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 15px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 39px;"><div style="height: 100%; min-height: 1px; width: 795.75px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 15px; width: 15px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: -15px; border-right-width: 35px; min-height: 939px; min-width: 795.75px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 定义使用 DQN 的算法</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">RL</span> <span class="cm-operator">=</span> <span class="cm-variable">DeepQNetwork</span>(<span class="cm-variable">n_actions</span><span class="cm-operator">=</span><span class="cm-variable">env</span>.<span class="cm-property">action_space</span>.<span class="cm-property">n</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-variable">n_features</span><span class="cm-operator">=</span><span class="cm-variable">env</span>.<span class="cm-property">observation_space</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>],</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-variable">learning_rate</span><span class="cm-operator">=</span><span class="cm-number">0.01</span>, <span class="cm-variable">e_greedy</span><span class="cm-operator">=</span><span class="cm-number">0.9</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-variable">replace_target_iter</span><span class="cm-operator">=</span><span class="cm-number">100</span>, <span class="cm-variable">memory_size</span><span class="cm-operator">=</span><span class="cm-number">2000</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-variable">e_greedy_increment</span><span class="cm-operator">=</span><span class="cm-number">0.0008</span>,)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">total_steps</span> <span class="cm-operator">=</span> <span class="cm-number">0</span> <span class="cm-comment"># 记录步数</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i_episode</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">100</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment"># 获取回合 i_episode 第一个 observation</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">observation</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-property">reset</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">ep_r</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">while</span> <span class="cm-keyword">True</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">env</span>.<span class="cm-property">render</span>()    <span class="cm-comment"># 刷新环境</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">action</span> <span class="cm-operator">=</span> <span class="cm-variable">RL</span>.<span class="cm-property">choose_action</span>(<span class="cm-variable">observation</span>)  <span class="cm-comment"># 选行为</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">observation_</span>, <span class="cm-variable">reward</span>, <span class="cm-variable">done</span>, <span class="cm-variable">info</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-property">step</span>(<span class="cm-variable">action</span>) <span class="cm-comment"># 获取下一个 state</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">x</span>, <span class="cm-variable">x_dot</span>, <span class="cm-variable">theta</span>, <span class="cm-variable">theta_dot</span> <span class="cm-operator">=</span> <span class="cm-variable">observation_</span>   <span class="cm-comment"># 细分开, 为了修改原配的 reward</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># x 是车的水平位移, 所以 r1 是车越偏离中心, 分越少</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># theta 是棒子离垂直的角度, 角度越大, 越不垂直. 所以 r2 是棒越垂直, 分越高</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">x</span>, <span class="cm-variable">x_dot</span>, <span class="cm-variable">theta</span>, <span class="cm-variable">theta_dot</span> <span class="cm-operator">=</span> <span class="cm-variable">observation_</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">r1</span> <span class="cm-operator">=</span> (<span class="cm-variable">env</span>.<span class="cm-property">x_threshold</span> <span class="cm-operator">-</span> <span class="cm-builtin">abs</span>(<span class="cm-variable">x</span>))<span class="cm-operator">/</span><span class="cm-variable">env</span>.<span class="cm-property">x_threshold</span> <span class="cm-operator">-</span> <span class="cm-number">0.8</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">r2</span> <span class="cm-operator">=</span> (<span class="cm-variable">env</span>.<span class="cm-property">theta_threshold_radians</span> <span class="cm-operator">-</span> <span class="cm-builtin">abs</span>(<span class="cm-variable">theta</span>))<span class="cm-operator">/</span><span class="cm-variable">env</span>.<span class="cm-property">theta_threshold_radians</span> <span class="cm-operator">-</span> <span class="cm-number">0.5</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">reward</span> <span class="cm-operator">=</span> <span class="cm-variable">r1</span> <span class="cm-operator">+</span> <span class="cm-variable">r2</span>   <span class="cm-comment"># 总 reward 是 r1 和 r2 的结合, 既考虑位置, 也考虑角度, 这样 DQN 学习更有效率</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># 保存这一组记忆</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">RL</span>.<span class="cm-property">store_transition</span>(<span class="cm-variable">observation</span>, <span class="cm-variable">action</span>, <span class="cm-variable">reward</span>, <span class="cm-variable">observation_</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">total_steps</span> <span class="cm-operator">&gt;</span> <span class="cm-number">1000</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">RL</span>.<span class="cm-property">learn</span>()  <span class="cm-comment"># 学习</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">ep_r</span> <span class="cm-operator">+=</span> <span class="cm-variable">reward</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">done</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-builtin">print</span>(<span class="cm-string">'episode: '</span>, <span class="cm-variable">i_episode</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-string">'ep_r: '</span>, <span class="cm-builtin">round</span>(<span class="cm-variable">ep_r</span>, <span class="cm-number">2</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">42</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-string">' epsilon: '</span>, <span class="cm-builtin">round</span>(<span class="cm-variable">RL</span>.<span class="cm-property">epsilon</span>, <span class="cm-number">2</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">43</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-keyword">break</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">44</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">45</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">observation</span> <span class="cm-operator">=</span> <span class="cm-variable">observation_</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">46</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">total_steps</span> <span class="cm-operator">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">47</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 最后输出 cost 曲线</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">48</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">RL</span>.<span class="cm-property">plot_cost</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">49</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 939px;"></div><div class="CodeMirror-gutters" style="height: 989px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div><div class="CodeMirror-gutter CodeMirror-foldgutter"></div><div class="CodeMirror-gutter CodeMirror-lint-markers"></div></div></div></div> <div> <button class="userSubmitBtn scriptRunBtn" onclick="evaluatePython(this);" disabled="" id="scriptRunBtn-1"></button> <button class="userSubmitBtn scriptAddBtn" onclick="addCodeArea(this);" disabled="" id="scriptAddBtn-1"></button> </div> <div class="scriptOutput" id="scriptOutput-1"></div> <img src="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym" class="scriptImage" id="scriptImage-1"></div> <p>这是更为典型的 RL cost 曲线:</p> <p><a href="https://static.mofanpy.com/static/results/reinforcement-learning/4-4-1.png" target="_blank"><img class="course-image lazy-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/loading.gif" data-src="https://static.mofanpy.com/static/results/reinforcement-learning/4-4-1.png" alt="4-4-1.png" title="4-4-1.png"></a></p> <h1 class="tut-h1-pad" id="MountainCar 例子">MountainCar 例子<a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym#MountainCar%20%E4%BE%8B%E5%AD%90" class="headerlink" title="Permalink to this headline">¶</a></h1> <p><div class="vsc-controller"><template shadowrootmode="open">
        <style>
          @import "chrome-extension://nffaoalbilbmmfgbnbgppjihopabppdk/shadow.css";
        </style>

        <div id="controller" style="top:5585.1484375px; left:231.3984375px; opacity:0.3">
          <span data-action="drag" class="draggable">1.00</span>
          <span id="controls">
            <button data-action="rewind" class="rw">«</button>
            <button data-action="slower">−</button>
            <button data-action="faster">+</button>
            <button data-action="advance" class="rw">»</button>
            <button data-action="display" class="hideButton">×</button>
          </span>
        </div>
      </template></div><video class="tut-content-video" controls="" loop="" autoplay="" muted=""> <source src="https://static.mofanpy.com/static/results/reinforcement-learning/mountaincar dqn.mp4" type="video/mp4"> Your browser does not support HTML5 video. </video></p> <p>代码基本和上述代码相同, 就只是在 reward 上动了下手脚.</p> <div><textarea class="scriptInput" style="display: none;">import gym
from RL_brain import DeepQNetwork

env = gym.make('MountainCar-v0')
env = env.unwrapped

print(env.action_space)
print(env.observation_space)
print(env.observation_space.high)
print(env.observation_space.low)

RL = DeepQNetwork(n_actions=3, n_features=2, learning_rate=0.001, e_greedy=0.9,
                  replace_target_iter=300, memory_size=3000,
                  e_greedy_increment=0.0001,)

total_steps = 0


for i_episode in range(10):

    observation = env.reset()
    ep_r = 0
    while True:
        env.render()

        action = RL.choose_action(observation)

        observation_, reward, done, info = env.step(action)

        position, velocity = observation_

        # 车开得越高 reward 越大
        reward = abs(position - (-0.5))

        RL.store_transition(observation, action, reward, observation_)

        if total_steps &gt; 1000:
            RL.learn()

        ep_r += reward
        if done:
            get = '| Get' if observation_[0] &gt;= env.unwrapped.goal_position else '| ----'
            print('Epi: ', i_episode,
                  get,
                  '| Ep_r: ', round(ep_r, 4),
                  '| Epsilon: ', round(RL.epsilon, 2))
            break

        observation = observation_
        total_steps += 1

RL.plot_cost()
</textarea><div class="CodeMirror cm-s-darcula" translate="no"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 43px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" readonly="" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; min-height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 15px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true" style="display: block; right: 0px; left: 39px;"><div style="height: 100%; min-height: 1px; width: 746px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 15px; width: 15px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 39px; margin-bottom: -15px; border-right-width: 35px; min-height: 1015px; min-width: 746.422px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -39px; width: 39px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">gym</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">RL_brain</span> <span class="cm-keyword">import</span> <span class="cm-variable">DeepQNetwork</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">env</span> <span class="cm-operator">=</span> <span class="cm-variable">gym</span>.<span class="cm-property">make</span>(<span class="cm-string">'MountainCar-v0'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">env</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-property">unwrapped</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">env</span>.<span class="cm-property">action_space</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">env</span>.<span class="cm-property">observation_space</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">env</span>.<span class="cm-property">observation_space</span>.<span class="cm-property">high</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">env</span>.<span class="cm-property">observation_space</span>.<span class="cm-property">low</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">RL</span> <span class="cm-operator">=</span> <span class="cm-variable">DeepQNetwork</span>(<span class="cm-variable">n_actions</span><span class="cm-operator">=</span><span class="cm-number">3</span>, <span class="cm-variable">n_features</span><span class="cm-operator">=</span><span class="cm-number">2</span>, <span class="cm-variable">learning_rate</span><span class="cm-operator">=</span><span class="cm-number">0.001</span>, <span class="cm-variable">e_greedy</span><span class="cm-operator">=</span><span class="cm-number">0.9</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-variable">replace_target_iter</span><span class="cm-operator">=</span><span class="cm-number">300</span>, <span class="cm-variable">memory_size</span><span class="cm-operator">=</span><span class="cm-number">3000</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-variable">e_greedy_increment</span><span class="cm-operator">=</span><span class="cm-number">0.0001</span>,)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">total_steps</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i_episode</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">10</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">observation</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-property">reset</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-variable">ep_r</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-keyword">while</span> <span class="cm-keyword">True</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">env</span>.<span class="cm-property">render</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">action</span> <span class="cm-operator">=</span> <span class="cm-variable">RL</span>.<span class="cm-property">choose_action</span>(<span class="cm-variable">observation</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">observation_</span>, <span class="cm-variable">reward</span>, <span class="cm-variable">done</span>, <span class="cm-variable">info</span> <span class="cm-operator">=</span> <span class="cm-variable">env</span>.<span class="cm-property">step</span>(<span class="cm-variable">action</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">position</span>, <span class="cm-variable">velocity</span> <span class="cm-operator">=</span> <span class="cm-variable">observation_</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-comment"># 车开得越高 reward 越大</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">reward</span> <span class="cm-operator">=</span> <span class="cm-builtin">abs</span>(<span class="cm-variable">position</span> <span class="cm-operator">-</span> (<span class="cm-operator">-</span><span class="cm-number">0.5</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">RL</span>.<span class="cm-property">store_transition</span>(<span class="cm-variable">observation</span>, <span class="cm-variable">action</span>, <span class="cm-variable">reward</span>, <span class="cm-variable">observation_</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">total_steps</span> <span class="cm-operator">&gt;</span> <span class="cm-number">1000</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">RL</span>.<span class="cm-property">learn</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">ep_r</span> <span class="cm-operator">+=</span> <span class="cm-variable">reward</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">done</span>:</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">42</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-variable">get</span> <span class="cm-operator">=</span> <span class="cm-string">'| Get'</span> <span class="cm-keyword">if</span> <span class="cm-variable">observation_</span>[<span class="cm-number">0</span>] <span class="cm-operator">&gt;=</span> <span class="cm-variable">env</span>.<span class="cm-property">unwrapped</span>.<span class="cm-property">goal_position</span> <span class="cm-keyword">else</span> <span class="cm-string">'| ----'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">43</div><div class="CodeMirror-gutter-elt" style="left: 29px; width: 9px;"><div class="CodeMirror-foldgutter-open CodeMirror-guttermarker-subtle"></div></div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-builtin">print</span>(<span class="cm-string">'Epi: '</span>, <span class="cm-variable">i_episode</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">44</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-variable">get</span>,</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">45</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-string">'| Ep_r: '</span>, <span class="cm-builtin">round</span>(<span class="cm-variable">ep_r</span>, <span class="cm-number">4</span>),</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">46</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">                  <span class="cm-string">'| Epsilon: '</span>, <span class="cm-builtin">round</span>(<span class="cm-variable">RL</span>.<span class="cm-property">epsilon</span>, <span class="cm-number">2</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">47</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">            <span class="cm-keyword">break</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">48</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">49</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">observation</span> <span class="cm-operator">=</span> <span class="cm-variable">observation_</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">50</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        <span class="cm-variable">total_steps</span> <span class="cm-operator">+=</span> <span class="cm-number">1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">51</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">52</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">RL</span>.<span class="cm-property">plot_cost</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" aria-hidden="true" style="left: -39px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">53</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 35px; width: 1px; border-bottom: 15px solid transparent; top: 1015px;"></div><div class="CodeMirror-gutters" style="height: 1065px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div><div class="CodeMirror-gutter CodeMirror-foldgutter"></div><div class="CodeMirror-gutter CodeMirror-lint-markers"></div></div></div></div> <div> <button class="userSubmitBtn scriptRunBtn" onclick="evaluatePython(this);" disabled="" id="scriptRunBtn-2"></button> <button class="userSubmitBtn scriptAddBtn" onclick="addCodeArea(this);" disabled="" id="scriptAddBtn-2"></button> </div> <div class="scriptOutput" id="scriptOutput-2"></div> <img src="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym" class="scriptImage" id="scriptImage-2"></div> <p>出来的 cost 曲线是这样:</p> <p><a href="https://static.mofanpy.com/static/results/reinforcement-learning/4-4-2.png" target="_blank"><img class="course-image lazy-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/loading.gif" data-src="https://static.mofanpy.com/static/results/reinforcement-learning/4-4-2.png" alt="4-4-2.png" title="4-4-2.png"></a></p> <p>这两个都只是例子而已, 具体的实施你也可以大动手脚, 比如你的 reward 定义得更好, 你的神经网络结构更好, 使得他们学的更快. 这些都是自己定义的.</p> <div id="bottom-donation-section"> <hr> <h3 id="bottom-donation-title">降低知识传递的门槛</h3> <div class="hover-move"> <a id="bottom-donation-button" href="https://mofanpy.com/support"><b>支持莫烦</b></a> </div> <p> 莫烦经常从互联网上学习知识，开源分享的人是我学习的榜样。 他们的行为也改变了我对教育的态度: <b>降低知识传递的门槛</b>。 <b>免费</b> 奉献我的所学正是受这种态度的影响。 <a href="https://mofanpy.com/support">【支持莫烦】</a> 能让我感到认同，我也更有理由坚持下去。 </p> <p> 我组建了微信群，欢迎大家加入，一起讨论学习问题。 </p> <a href="https://mofanpy.com/static/img/description/mofanpyQR.png"> <img class="lazy-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/mofanpyQR.png" alt="wechat" style="width:50%;padding:10px;margin-left: auto;margin-right: auto;display: block"> </a> </div> </div> <div class="pad-page-navigation"> <div class="PageNavigation"> <a class="prev" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN3"> <b>«</b> DQN 思维决策</a> <a class="next" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN"> Double DQN <b>»</b></a> </div> </div> </div> <div class="section ie-size"> <div class="comment-section"> <button onclick="commentSortDateSwitch(&#39;https://mofanpy.com/api/comment&#39;, 53)" value="oldFirst" id="comment-sort-btn" class="comment-btn" style="margin: 0 0 2em 0;"> ⇌ 展示最早 </button> <div class="comment-page-nav" id="comment-page-nav1"><button class="comment-page-nav-btn" style="color: rgb(217, 217, 217);">1</button><button class="comment-page-nav-btn">2</button><button class="comment-page-nav-btn">下一页</button></div> <ul class="comments" id="bottom-comments-ul"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/default_user_icon.png"></div><div class="comment-content" id="comment-content-div-3051"><div class="comment-author">1245069180</div><div class="comment-date">03-20</div><div class="comment-body-hidden" id="comment-hidden-id-3051">老师，为什么在运行run_CArtPole时，会显示RL_brain里面的choose_action函数有错，报错为：TypeError: tuple indices must be integers or slices, not tuple</div><div class="comment-body" id="comment-id-3051">老师，为什么在运行run_CArtPole时，会显示RL_brain里面的choose_action函数有错，报错为：TypeError: tuple indices must be integers or slices, not tuple</div><button class="comment-like-btn comment-btn" id="like-btn-id-3051"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>2</button><button class="hide-button comment-btn" id="reply-btn-id-3051">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-3051"></div><div class="comment-reply-div" id="comment-reply-id-3051"></div><ul class="reply-ul" id="reply-ul-id-3051"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/8B2EB223ECEC97C044F0F622671FFC7A.jpeg"></div><div class="comment-content" id="comment-content-div-3062"><div class="comment-author">凪旨</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">1245069180 ⤴</div><div class="comment-date">04-01</div><div class="comment-body-hidden" id="comment-hidden-id-3062">gym版本的问题，新版中step和reset函数返回值多了一部分，将observation= env.reset() 改为 observation, _ = env.reset()，同时将observation_, reward, done, info= env.step(action) 改为 observation_, reward, done, info, _ = env.step(action)就行</div><div class="comment-body" id="comment-id-3062">gym版本的问题，新版中step和reset函数返回值多了一部分，将observation= env.reset() 改为 observation, _ = env.reset()，同时将observation_, reward, done, info= env.step(action) 改为 observation_, reward, done, info, _ = env.step(action)就行</div><button class="comment-like-btn comment-btn" id="like-btn-id-3062"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>1</button><button class="hide-button comment-btn" id="reply-btn-id-3062">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-3062"></div><div class="comment-reply-div" id="comment-reply-id-3062"></div></li></ul></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/0F520129A7FA9464977BD93B5AE44060.jpeg"></div><div class="comment-content" id="comment-content-div-1878"><div class="comment-author">🐇Debug୧⍤⃝🥕</div><div class="comment-date">2021-12-13</div><div class="comment-body-hidden" id="comment-hidden-id-1878">大神呀，我用DQN去做迷宫问题，obs为1-16中的单个数字，在神经网络输入时总是报错 Input(Y) has error dim.Y&amp;#x27;dims[0] must be equal to 1But received Y&amp;#x27;dims[0] is 15</div><div class="comment-body" id="comment-id-1878">大神呀，我用DQN去做迷宫问题，obs为1-16中的单个数字，在神经网络输入时总是报错 Input(Y) has error dim.Y'dims[0] must be equal to 1But received Y'dims[0] is 15</div><button class="comment-like-btn comment-btn" id="like-btn-id-1878"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1878">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1878"></div><div class="comment-reply-div" id="comment-reply-id-1878"></div><ul class="reply-ul" id="reply-ul-id-1878"></ul></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/jiajiawen888.png"></div><div class="comment-content" id="comment-content-div-1872"><div class="comment-author">jiajiawen</div><div class="comment-date">2021-12-08</div><div class="comment-body-hidden" id="comment-hidden-id-1872">请问老师，我是小白一只，如何解决action行为数组不确定的情况</div><div class="comment-body" id="comment-id-1872">请问老师，我是小白一只，如何解决action行为数组不确定的情况</div><button class="comment-like-btn comment-btn" id="like-btn-id-1872"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1872">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1872"></div><div class="comment-reply-div" id="comment-reply-id-1872"></div><ul class="reply-ul" id="reply-ul-id-1872"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/my_pic.jpg"></div><div class="comment-content" id="comment-content-div-1873"><div class="comment-author comment-author-admin">莫烦Python</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">jiajiawen ⤴</div><div class="comment-date">2021-12-08</div><div class="comment-body-hidden" id="comment-hidden-id-1873">没有什么特别好的办法，你可以把输出做成一个rnn序列，记录每次不定长的序列输出，反向传播这个rnn。但是这提高了训练难度，应该很难训练好</div><div class="comment-body" id="comment-id-1873">没有什么特别好的办法，你可以把输出做成一个rnn序列，记录每次不定长的序列输出，反向传播这个rnn。但是这提高了训练难度，应该很难训练好</div><button class="comment-like-btn comment-btn" id="like-btn-id-1873"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1873">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1873"></div><div class="comment-reply-div" id="comment-reply-id-1873"></div></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/jiajiawen888.png"></div><div class="comment-content" id="comment-content-div-1874"><div class="comment-author">jiajiawen</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">jiajiawen ⤴</div><div class="comment-date">2021-12-10</div><div class="comment-body-hidden" id="comment-hidden-id-1874">好的，谢谢！！！ 请问关于看课程中关于DQN部分的代码好像没有涉及保存训练模型的地方，请问在哪里有？</div><div class="comment-body" id="comment-id-1874">好的，谢谢！！！ 请问关于看课程中关于DQN部分的代码好像没有涉及保存训练模型的地方，请问在哪里有？</div><button class="comment-like-btn comment-btn" id="like-btn-id-1874"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1874">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1874"></div><div class="comment-reply-div" id="comment-reply-id-1874"></div></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/haiduo.jpeg"></div><div class="comment-content" id="comment-content-div-2413"><div class="comment-author">舵主</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">jiajiawen ⤴</div><div class="comment-date">2022-05-21</div><div class="comment-body-hidden" id="comment-hidden-id-2413">但凡你浏览下老师的整个教程，你就知道了</div><div class="comment-body" id="comment-id-2413">但凡你浏览下老师的整个教程，你就知道了</div><button class="comment-like-btn comment-btn" id="like-btn-id-2413"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-2413">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-2413"></div><div class="comment-reply-div" id="comment-reply-id-2413"></div></li></ul></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/8D8CA930483853999CA875BCD8BB33AB.jpeg"></div><div class="comment-content" id="comment-content-div-1126"><div class="comment-author">欢乐马</div><div class="comment-date">2021-04-27</div><div class="comment-body-hidden" id="comment-hidden-id-1126">请教下，对于CartPole任务，距离和角度的奖励 - r1和r2，在归一化后，为什么还需要分别减去0.8和0.5。另外，为了尽量避免done的情况，在done的情况下，对reward的值做一个较大的惩罚，如-10，效果会怎么样呢</div><div class="comment-body" id="comment-id-1126">请教下，对于CartPole任务，距离和角度的奖励 - r1和r2，在归一化后，为什么还需要分别减去0.8和0.5。另外，为了尽量避免done的情况，在done的情况下，对reward的值做一个较大的惩罚，如-10，效果会怎么样呢</div><button class="comment-like-btn comment-btn" id="like-btn-id-1126"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1126">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1126"></div><div class="comment-reply-div" id="comment-reply-id-1126"></div><ul class="reply-ul" id="reply-ul-id-1126"><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/407F5181344CEA214A98A2103633AED3.jpeg"></div><div class="comment-content" id="comment-content-div-2055"><div class="comment-author">百把人</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">欢乐马 ⤴</div><div class="comment-date">2022-03-07</div><div class="comment-body-hidden" id="comment-hidden-id-2055">同样的困惑。。请问你想明白了吗？</div><div class="comment-body" id="comment-id-2055">同样的困惑。。请问你想明白了吗？</div><button class="comment-like-btn comment-btn" id="like-btn-id-2055"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-2055">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-2055"></div><div class="comment-reply-div" id="comment-reply-id-2055"></div></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/haiduo.jpeg"></div><div class="comment-content" id="comment-content-div-2414"><div class="comment-author">舵主</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">欢乐马 ⤴</div><div class="comment-date">2022-05-21</div><div class="comment-body-hidden" id="comment-hidden-id-2414">貌似调参得出的，没啥特别依据吧</div><div class="comment-body" id="comment-id-2414">貌似调参得出的，没啥特别依据吧</div><button class="comment-like-btn comment-btn" id="like-btn-id-2414"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-2414">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-2414"></div><div class="comment-reply-div" id="comment-reply-id-2414"></div></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/B644E01BD8DBB7F9F3E0F0D554BA9723.jpeg"></div><div class="comment-content" id="comment-content-div-3123"><div class="comment-author">➡️🆒🎶</div><div class="comment-author-reply">回复</div><div class="comment-author comment-replier">欢乐马 ⤴</div><div class="comment-date">07-17</div><div class="comment-body-hidden" id="comment-hidden-id-3123">应该是调参调出来的一个大致的数，r1带上-0.8后意味着之后在max范围的20%内才能获得正奖励，r2-0.5意味着只有在范围内50%才能获得正奖励，这样的惩罚力度更容易防止它gameover。简单来说如果我们不减这两个数，那gameover的时候是0reward，完全居中是最高reward，这样显然不如reward有正有负来的好。为什么reward有正有负e.g.[-0.5,0.5]比[0,1]好呢，举个例子，假设训练刚开始的时候比较倒霉，随机做出的行为大部分是次优的，甚至几乎是错误的，有正有负的reward机制会直接给这些action打上负分，导致下一次再遇到同样情况的时候大概率就直接不会再选了；但加入我们是[0,1]的reward取值，我们甚至会对这种很离谱的行为还给上一点点奖励，虽然很少，但是毕竟给了，这就可能导致当它下一次再走到这里时，它大概率觉得，这个action的Q值是正的，比另一个没探索过，Q值依然为0的action要好，而实际上这里没被探索的action才是最好的action...我觉得大概可以这样理解。但是其实[0,1]也是可行的，比如我们把epsilon increment调的很小的话也能弥补一些问题。</div><div class="comment-body" id="comment-id-3123">应该是调参调出来的一个大致的数，r1带上-0.8后意味着之后在max范围的20%内才能获得正奖励，r2-0.5意味着只有在范围内50%才能获得正奖励，这样的惩罚力度更容易防止它gameover。简单来说如果我们不减这两个数，那gameover的时候是0reward，完全居中是最高reward，这样显然不如reward有正有负来的好。为什么reward有正有负e.g.[-0.5,0.5]比[0,1]好呢，举个例子，假设训练刚开始的时候比较倒霉，随机做出的行为大部分是次优的，甚至几乎是错误的，有正有负的reward机制会直接给这些action打上负分，导致下一次再遇到同样情况的时候大概率就直接不会再选了；但加入我们是[0,1]的reward取值，我们甚至会对这种很离谱的行为还给上一点点奖励，虽然很少，但是毕竟给了，这就可能导致当它下一次再走到这里时，它大概率觉得，这个action的Q值是正的，比另一个没探索过，Q值依然为0的action要好，而实际上这里没被探索的action才是最好的action...我觉得大概可以这样理解。但是其实[0,1]也是可行的，比如我们把epsilon increment调的很小的话也能弥补一些问题。</div><button class="comment-like-btn comment-btn" id="like-btn-id-3123"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-3123">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-3123"></div><div class="comment-reply-div" id="comment-reply-id-3123"></div></li></ul></li><li class="comment-li"><div class="comment-thumbnail"><img class="cycle-img" src="./OpenAI gym 环境库 _ 莫烦Python_files/F1D2D76EC369294D1237AC6C053D5525.jpeg"></div><div class="comment-content" id="comment-content-div-1121"><div class="comment-author">u</div><div class="comment-date">2021-04-26</div><div class="comment-body-hidden" id="comment-hidden-id-1121">GYM的render渲染好像有问题

```import gym
env = gym.make(&amp;#x27;CartPole-v0&amp;#x27;)
env.reset()
for _ in range(1000):
    env.render()
    env.step(env.action_space.sample())

```
这样尝试能正常渲染出来
可是在RL的代码中，env.render会让我的程序崩溃
把它注释掉就能正常运行，不知道是什么原因造成的</div><div class="comment-body" id="comment-id-1121">GYM的render渲染好像有问题<br><br><span><code class="plaintext hljs" style="display: inline-block; color: rgb(254, 113, 113); background-color: rgb(229, 232, 232); overflow-x: inherit; padding: 0px 4px; font-size: 1em;"></code></span><span><code class="plaintext hljs" style="display: inline-block; color: rgb(254, 113, 113); background-color: rgb(229, 232, 232); overflow-x: inherit; padding: 0px 4px; font-size: 1em;">import gym<br>env = gym.make('CartPole-v0')<br>env.reset()<br>for _ in range(1000):<br>    env.render()<br>    env.step(env.action_space.sample())<br><br></code></span><span><code class="plaintext hljs" style="display: inline-block; color: rgb(254, 113, 113); background-color: rgb(229, 232, 232); overflow-x: inherit; padding: 0px 4px; font-size: 1em;"></code></span><br>这样尝试能正常渲染出来<br>可是在RL的代码中，env.render会让我的程序崩溃<br>把它注释掉就能正常运行，不知道是什么原因造成的</div><button class="comment-like-btn comment-btn" id="like-btn-id-1121"><svg fill="#8590a6" viewBox="0 0 24 18" width="16" height="16" style="margin-right: 5px;"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"></path></svg>0</button><button class="hide-button comment-btn" id="reply-btn-id-1121">回复</button></div><div class="comment-reply-tools-div" id="comment-reply-tools-id-1121"></div><div class="comment-reply-div" id="comment-reply-id-1121"></div><ul class="reply-ul" id="reply-ul-id-1121"></ul></li></ul> <div class="comment-page-nav" id="comment-page-nav2"><button class="comment-page-nav-btn" style="color: rgb(217, 217, 217);">1</button><button class="comment-page-nav-btn">2</button><button class="comment-page-nav-btn">下一页</button></div> <script async="">
    commentGet('https://mofanpy.com/api/comment', "53", )
  </script> </div> <ins class="adsbygoogle" style="display: block; text-align: center; height: 175px;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-4601203457616636" data-ad-slot="3952173485" data-adsbygoogle-status="done"><div id="aswift_3_host" style="border: none; height: 175px; width: 700px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins> <div class="comment-section"> <div class="comment-reply-tools-div" id="comment-reply-tools-div-0" style="margin-left: 0"></div> <div style="display: flex;"> <textarea class="comment-textarea" name="comments" id="comment-textarea-main" oninput="this.style.height = &quot;&quot;;this.style.height = this.scrollHeight + &quot;px&quot;" maxlength="2000" disabled="disabled" placeholder="留言请先登录"></textarea> <button class="comment-submit-btn" id="comment-submit" onclick="commentPut(&#39;https://mofanpy.com/api/comment&#39;, &#39;53&#39;, null, null, &#39;comment-textarea-main&#39;)"> 登录 </button> </div> <script type="text/javascript">
    $(document).ready(function () {
      if ('False' === "True") {
          $("#comment-submit").text("发布");
        $("#comment-reply-tools-div-0").append(
          $("<button>", {
            class: "comment-btn",
          }).on("click", function () {
            insertCodePlaceholder(0, 'comment-textarea-main')
          }).html("&#60;&#47;&#62;")
            .append($("<span>", {
              class: "tooltiptext",
              text: "选中多行代码高亮"
            }))
        )
      }
    })
    if ('False' === "False") {
        $("#comment-textarea-main").attr("disabled", true).prop("placeholder", "留言请先登录");
    } else {
      $("#comment-textarea-main").attr("disabled", false
      ).prop("placeholder", "")
    }
    $(".comment-textarea").on("keydown", textareaKeydown);
  </script> </div> </div> <div class="tut-content-menu"> <a class="hover-move" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/"> <img src="./OpenAI gym 环境库 _ 莫烦Python_files/tutorial_contents_icon.jpg" alt="教程目录"></a> </div> </div> <div class="tut-right-bar"> <div class="tut-table-content-nav section" id="tut-table-content-nav-scroll"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/"><p><b>强化学习 (Reinforcement Learning)</b></p></a> <ul class="tut-table-content-nav-contents"> <p>简介</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-RL">什么是强化学习</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-RL-methods">强化学习方法汇总</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/why">为什么用强化学习 Why?</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/requirment">课程要求</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Q-learning</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-q-learning">什么是 Q Leaning</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/general-rl">小例子</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-q1">Q-learning 算法更新</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-q2">Q-learning 思维决策</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Sarsa</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-sarsa">什么是 Sarsa</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-sarsa1">Sarsa 算法更新</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-sarsa2">Sarsa 思维决策</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-sarsa-lambda">什么是 Sarsa(lambda)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/tabular-sarsa-lambda">Sarsa-lambda</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Deep Q Network</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-DQN">什么是 DQN</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN1">DQN 算法更新</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN2">DQN 神经网络</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DQN3">DQN 思维决策</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym" style="color:#ffffff;" id="nav-to-this-li">OpenAI gym 环境库</a> <ul style="padding-left: 1em"> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym#%E8%A6%81%E7%82%B9" style="color:#ffffff;">要点</a> </li> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym#%E5%AE%89%E8%A3%85%20gym" style="color:#ffffff;">安装 gym</a> </li> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym#CartPole%20%E4%BE%8B%E5%AD%90" style="color:#ffffff;">CartPole 例子</a> </li> <li> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/gym#MountainCar%20%E4%BE%8B%E5%AD%90" style="color:#ffffff;">MountainCar 例子</a> </li> </ul> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/double_DQN">Double DQN</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/prioritized-replay">Prioritized Experience Replay (DQN)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/dueling-DQN">Dueling DQN</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Policy Gradient</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-PG">什么是 Policy Gradients</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/policy-gradient-softmax1">Policy Gradients 算法更新</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/policy-gradient-softmax2">Policy Gradients 思维决策</a> </li> </ul> <ul class="tut-table-content-nav-contents"> <p>Actor Critic</p> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-AC">什么是 Actor Critic</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/actor-critic">Actor Critic</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-DDPG">什么是 DDPG</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DDPG">Deep Deterministic Policy Gradient (DDPG)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/intro-A3C">什么是 Asynchronous Advantage Actor-Critic (A3C)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/A3C">Asynchronous Advantage Actor-Critic (A3C)</a> </li> <li class="tut-table-content-nav-li"> <a href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/DPPO">Distributed Proximal Policy Optimization (DPPO)</a> </li> </ul> <script type="text/javascript" async="">
            let myElement = document.getElementById(id = "nav-to-this-li");
            let topPos = myElement.offsetTop;
            document.getElementById('tut-table-content-nav-scroll').scrollTop = topPos - 30;
        </script> </div> <div class="section ie-size" id="right-fix-ads"> <script async="" src="./OpenAI gym 环境库 _ 莫烦Python_files/f(7).txt" crossorigin="anonymous" data-checked-head="true"></script> <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-4601203457616636" data-ad-slot="8101278819" data-adsbygoogle-status="done" data-ad-status="filled"><div id="aswift_4_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 250px; width: 300px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_4" name="aswift_4" style="left:0;position:absolute;top:0;border:0;width:300px;height:250px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="300" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./OpenAI gym 环境库 _ 莫烦Python_files/ads(2).html" data-google-container-id="a!5" data-google-query-id="CLyC1t2Hx4ADFYMZKgodAncDoA" data-load-complete="true"></iframe></div></ins> </div> <div class="section ie-size" id="right-fix-ads"> <script async="" src="./OpenAI gym 环境库 _ 莫烦Python_files/f(7).txt" crossorigin="anonymous" data-checked-head="true"></script> <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-4601203457616636" data-ad-slot="5136097798" data-adsbygoogle-status="done" data-ad-status="filled"><div id="aswift_5_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 250px; width: 300px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_5" name="aswift_5" style="left:0;position:absolute;top:0;border:0;width:300px;height:250px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="300" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./OpenAI gym 环境库 _ 莫烦Python_files/ads(3).html" data-google-container-id="a!6" data-google-query-id="CN6q2t2Hx4ADFQ4DYAodsb8OoA" data-load-complete="true"></iframe></div></ins> </div> </div> <div id="video-container-small-btns" style="display: block;"><button>&lt;&lt;</button><button>↑</button></div></main> <footer> <p>关注我的动向:</p> <ul> <li><a href="https://github.com/MorvanZhou" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 24 24"> <path d="M12 1A10.89 10.89 0 0 0 1 11.77 10.79 10.79 0 0 0 8.52 22c.55.1.75-.23.75-.52v-1.83c-3.06.65-3.71-1.44-3.71-1.44a2.86 2.86 0 0 0-1.22-1.58c-1-.66.08-.65.08-.65a2.31 2.31 0 0 1 1.68 1.11 2.37 2.37 0 0 0 3.2.89 2.33 2.33 0 0 1 .7-1.44c-2.44-.27-5-1.19-5-5.32a4.15 4.15 0 0 1 1.11-2.91 3.78 3.78 0 0 1 .11-2.84s.93-.29 3 1.1a10.68 10.68 0 0 1 5.5 0c2.1-1.39 3-1.1 3-1.1a3.78 3.78 0 0 1 .11 2.84A4.15 4.15 0 0 1 19 11.2c0 4.14-2.58 5.05-5 5.32a2.5 2.5 0 0 1 .75 2v2.95c0 .35.2.63.75.52A10.8 10.8 0 0 0 23 11.77 10.89 10.89 0 0 0 12 1"></path> </svg> </a></li> <li><a href="https://gitee.com/MorvanZhou" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 32 32"> <g fill="none" fill-rule="evenodd"> <circle cx="16" cy="16" fill="#4a4a4a" r="16"></circle> <path d="m24.0987698 14.2225144h-9.0863697c-.4362899.000207-.7900048.3538292-.790326.7901191l-.0005173 1.9752185c-.0003277.4363707.353328.7902117.7896987.790326.0000712 0 .0001424 0 .0002135-.0002135l5.5317648-.0000461c.4363708-.0000102.7901221.3537352.7901257.790106 0 .0000022 0 .0000044-.0000066.0000066v.1975077.1975318c0 1.3091122-1.0612451 2.3703573-2.3703573 2.3703573h-7.5067195c-.4363081-.0000218-.790009-.353713-.7900429-.7900211l-.0002069-7.5059917c-.0001014-1.3091122 1.0611145-2.3703865 2.3702267-2.3704226.0000217 0 .0000435 0 .0000653.0000653h11.0602463c.4361793-.0004902.7898484-.35394.7906091-.79011894l.0012251-1.97521881c.0007606-.43637034-.3527683-.79033806-.7891389-.79060871-.0001634-.0000001-.0003268-.00000015-.0004901.00048976h-11.0617654c-3.27278051 0-5.92589329 2.65311278-5.92589329 5.9258933v11.0612755c0 .4363707.35374837.7901191.7901191.7901191h11.65447149c2.9454379 0 5.3331872-2.3877493 5.3331872-5.3331872v-4.5430682c0-.4363707-.3537484-.7901191-.7901191-.7901191z" fill="#02c39a"></path> </g> </svg> </a></li> <li><a href="https://www.youtube.com/user/MorvanZhou" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 24 24"> <path d="M23,9.71a8.5,8.5,0,0,0-.91-4.13,2.92,2.92,0,0,0-1.72-1A78.36,78.36,0,0,0,12,4.27a78.45,78.45,0,0,0-8.34.3,2.87,2.87,0,0,0-1.46.74c-.9.83-1,2.25-1.1,3.45a48.29,48.29,0,0,0,0,6.48,9.55,9.55,0,0,0,.3,2,3.14,3.14,0,0,0,.71,1.36,2.86,2.86,0,0,0,1.49.78,45.18,45.18,0,0,0,6.5.33c3.5.05,6.57,0,10.2-.28a2.88,2.88,0,0,0,1.53-.78,2.49,2.49,0,0,0,.61-1,10.58,10.58,0,0,0,.52-3.4C23,13.69,23,10.31,23,9.71ZM9.74,14.85V8.66l5.92,3.11C14,12.69,11.81,13.73,9.74,14.85Z"></path> </svg> </a></li> <li><a href="https://space.bilibili.com/243821484#!/" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 1000 1000"> <path d="M957.6,281.2c0-29.1-4.8-33.9-33.9-33.9c-95.3,0-190.6,0-285.1,0h-25.8c27.5-40.4,52.5-76.7,76.7-113.1c17.8-25.8,35.5-52.5,53.3-78.3c9.7-13.7,12.1-28.3-2.4-40.4C727.4,5,712.8,9.8,700.7,27.6c-1.6,2.4-3.2,4.8-4.8,6.5c-43.6,64.6-88,129.2-131.7,193c-14.5,21-54.1,28.3-75.9,15.3C401.9,194.8,315.4,148,229,101.1c-14.5-8.1-29.1-7.3-37.2,8.9c-8.1,15.3-2.4,28.3,12.9,36.3c37.2,20.2,73.5,40.4,110.7,60.6c22.6,12.1,44.4,24.2,67,36.3c-0.8,1.6-1.6,3.2-1.6,4.8h-20.2c-96.1,0-191.4,0-287.5,0c-23.4,0-31.5,7.3-31.5,28.3C40.8,478.3,40.8,681,40.8,883c0,20.2,8.9,28.3,29.1,29.1c18.6,0,37.2,0.8,55.7,0c14.5-0.8,21,2.4,25.8,18.6c9.7,37.2,39.6,59,72.7,59c32.3-0.8,62.2-23.4,71.1-59c4-17,12.1-17.8,25.8-17.8c119.5,0,238.3,0.8,357.8,0c17,0,26.7,2.4,31.5,21.8c8.9,31.5,30.7,51.7,64.6,54.9c29.1,3.2,62.2-12.1,70.3-42.8c9.7-33.9,29.9-36.3,57.3-33.1c7.3,0.8,15.3,0,22.6,0c29.1,0,33.9-4.8,33.9-33.1C957.6,679.4,957.6,479.9,957.6,281.2z M220.1,941.1c-15.3-0.8-22.6-12.1-26.7-28.3H250C245.2,929.8,237.1,942.7,220.1,941.1z M781.5,941.1c-17,0.8-25-11.3-30.7-29.1h57.3C803.3,928.2,796,940.3,781.5,941.1z M911.5,864.4h-823v-571h823V864.4z M170.1,824.8c110.7,0,220.5,0,331.2,0s220.5,0,331.2,0c30.7,0,37.2-5.7,37.2-35.5c0-138.9-0.8-277.8-0.8-416.8c0-29.1-6.5-34.7-35.5-34.7c-221.3,0-442.6,0-663.9,0c-29.1,0-34.7,5.7-34.7,35.5c0,138.1-0.8,276.2-0.8,415.2C132.9,820,137.7,824.8,170.1,824.8z M182.2,387h636.5v389.3H182.2V387z M632.9,611.6c-15.3-0.8-24.2,8.1-26.7,22.6c-1.6,9.7-1.6,21-6.5,27.5c-8.1,9.7-21,22.6-31.5,21.8c-11.3,0-24.2-12.1-33.1-22.6c-5.7-6.5-5.7-17.8-7.3-27.5c-1.6-14.5-10.5-23.4-24.2-23.4c-14.5,0-23.4,8.9-25.8,24.2c-0.8,8.1,0,18.6-4.8,23.4c-9.7,10.5-21,23.4-33.9,25.8c-17,4-28.3-11.3-34.7-26.7c-3.2-8.1-1.6-19.4-5.7-25.8c-5.7-8.9-16.2-19.4-24.2-19.4c-8.1,0-22.6,12.1-23.4,20.2c-2.4,35.5,10.5,66.2,40.4,87.2c27.5,19.4,56.5,20.2,85.6,4.8c8.9-4.8,17-11.3,25-17.8c1.6,1.6,4,2.4,4.8,3.2c27.5,25,59.8,32.3,93.7,16.2c36.3-17.8,51.7-49.3,53.3-88.8C656.3,622.1,648.2,612.4,632.9,611.6z M764.5,545.3c-46.8-29.1-93.7-57.3-141.3-84.8c-12.1-7.3-25-3.2-32.3,9.7c-7.3,12.1-4.8,25,8.1,32.3c46,28.3,92.1,56.5,139.7,83.2c17.8,9.7,36.3-2.4,36.3-25.8C773.4,557.5,770.2,548.6,764.5,545.3z M389.7,488c-0.8-7.3-12.1-13.7-17-17.8c-7.3,0.8-9.7,0.8-11.3,1.6c-42.8,19.4-86.4,38-128.4,59.8c-6.5,3.2-10.5,20.2-8.1,29.9c3.2,13.7,17,17.8,29.9,12.1c42-18.6,84-37.2,125.2-58.2C386.5,512.2,391.4,496.9,389.7,488z"></path> </svg> </a></li><li><a href="http://i.youku.com/pythontutorial" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 1000 1000"> <g> <path d="M638.1,646.2h1.6l0.1-51.9h-11l-0.1,39C628.6,641.8,631.8,646.2,638.1,646.2z"></path> <path d="M559.1,684.6l80.5,0.1l0.1-17.1l-5.9-0.1c-16,0-28.7-12.6-28.6-28.6l0.1-44.6l-8.5,0v0.8c-0.1,36.7-9.3,67.6-18,78l-19.6-11.8L559.1,684.6z"></path> <path d="M596.9,535.9h8.4v30h-8.4V535.9z"></path> <path d="M559,729c0,5.3,0.7,9.2,2.9,11.5c2,2,4.9,2.9,9,2.9c0.3,0,12,0,25.6,0c1.7,0,3.5,0,5.2,0c13.6,0,25.4,0,25.7,0c4.1,0,7-0.9,9-2.9c2.3-2.3,3-6.2,3-11.4l0-17.5l-80.5-0.2L559,729z"></path> <path d="M348.9,373.3c21.2,0,38.6-21.9,38.6-48.7c0-26.9-17.2-48.9-38.5-48.9h0c-21.2,0-38.6,21.9-38.7,48.8c0,13,4,25.3,11.2,34.5C328.9,368.2,338.5,373.3,348.9,373.3z"></path> <path d="M573.2,594.9v-0.8l-13.9,0l-0.1,63.4l1.5-2.3C569.6,642.3,573.2,617.5,573.2,594.9z"></path> <path d="M892,10H108c-54.1,0-98,43.9-98,98v784c0,54.1,43.9,98,98,98h784c54.2,0,98-43.9,98-98V108C990,53.9,946.2,10,892,10z M595.9,264.4c0.9-16,8.4-23.4,23.3-23.4c14.6,0,23.3,8.4,23.7,23.5V311l61.3-62.5c3.7-3.7,10.8-7.4,18.2-7.4c6.1,0,11.5,2.4,16.1,7.2c16.9,17.5-1.7,37.1-2.5,37.9l-41.7,39.2l46.4,42.8c5.4,5,8.7,12.7,9,20.6c0.2,6.4-1.6,11.9-5.2,15.7c-4.1,4.1-10.2,6.5-16.9,6.5c-6.5,0-12.4-2.2-16.9-6.1c-3.4-3.2-66.2-61.1-66.2-61.1l-1.3-1.4v49.2c-0.7,14-8.7,21.1-23.5,21.1v0.9l0,0l-0.3-0.9c-14.8,0-22.5-6.9-23.3-21.2L595.9,264.4L595.9,264.4z M349.2,234c46.1,0.1,83.6,40.1,83.5,89.2c-0.1,54-33,88.9-83.7,88.9v0.9l-0.2-0.9c-24.7,0-45.8-9.1-61.1-26.1c-14.5-16.2-22.5-38.6-22.4-63C265.4,273.9,303,234,349.2,234z M438,502.7c26.9,19.6,48.9,37.8,52.7,41l-21.3,23.9c-4.3-4-32.7-29.9-49.5-43.3L438,502.7z M164.3,476.3c-3.6,0-7.6-0.9-11.8-2.8c-21-9-13.1-30.6-11.3-34.8l25.5-56.7L102,272c-0.4-0.9-11.8-23.3,8.1-35c4.3-2.5,8.6-3.8,12.9-3.8c11,0,19.4,8.6,23.6,16.6l44.9,77l33.5-74.6c3.7-9.3,9.1-18.9,21.3-18.9c3.9,0,8.3,0.9,13.2,2.9c6.4,2.4,10.7,6.4,13,11.6c4.2,10.1-0.8,21.8-0.8,21.9l-84,185.7C183,465.7,176.6,476.3,164.3,476.3z M499.8,735.9c-2.4,12.7-6.9,21.4-13.6,26.7c-6.2,5-15.3,7.4-28.6,7.4l-20,0c-6.5,0-11.5-0.6-16.6-2c-5-1.4-9.2-3.7-12.2-6.7c-3.1-2.8-5.5-6.8-7-11.9c-1.5-4.9-2-10.6-2-17.6l0.3-129.3h-6.9c-2.8,31.6-8.6,58.7-17.6,81.7c-11,28.4-29.7,57.4-58.7,87.6L292,752.3v19.5l-32.7-0.1l0.3-132.7c0,0-9.3,14.3-18.2,26.3l-24.6-22.7c30.3-41.5,53.3-86.6,69.2-142.3l31.1,12.3c-5.3,21.9-13.7,46.3-24.7,70.2L292,747.9c24.6-23.6,41.2-47.9,52.2-73.2c8.4-17.8,13.8-42,16.3-72.3l-55.9-0.1l0-28.9l56.6,0.1l0.1-73.1l32.8,0.1l-0.2,73.1l102.5,0.2l0,28.9l-63.7-0.2L432.3,729c0,11.2,6.6,13.7,12.3,13.7h7.3c5.1,0,9-1.2,11.6-3.7c2.8-2.5,4.3-6.3,4.9-11.8c1-6.6,3-28,3.8-40.8l32.5,9.7C503.4,706.4,501.3,726.8,499.8,735.9z M437.8,348.9v-83.3c0.8-17.2,8.3-25.6,22.8-25.6c13.5,0.6,20.6,9,21.4,25.6V349c0.9,18.2,13.1,29.9,31.3,30c17.5,0,30.3-12.3,31.2-29.9v-83.3c0.5-16.2,8.2-25,22-25.4c14,0.5,21.5,9.1,22.3,25.5v83.3c-2.2,42.2-27,63.1-75.8,63.9C464.6,412,439.3,390.5,437.8,348.9z M668.6,536.1l-39.7-0.1l0,30l39.3,0l-0.3,151.6h-0.1l0,24.2c0,11-2.4,18.2-7.6,22.3c-4.6,4.2-13.1,6.1-25.6,6.1l-32.7-0.1h-5.1l-32.7-0.1c-12.5,0-20.8-2-25.5-6.2c-5.2-4.1-7.6-11.4-7.5-22.4l0-24.2l0.3-151.6l42.1,0.1l0.1-30l-42.1-0.1l0-28.8h137.3L668.6,536.1z M806,742.2c0.1,11-2.4,18.3-7.6,22.4c-4.6,4.1-13.1,6.1-25.6,6.1h-15.3l-23.4-0.1h-15.3c-12.5,0-20.9-2.1-25.5-6.2c-5.2-4.1-7.7-11.4-7.5-22.4L686,652l120.1,0.3L806,742.2z M813.1,635.9l-135.3-0.3v-27.4l55,0.1l0.1-39l-26.9,0l-0.4,1.5c-2.5,12.7-6.1,25.6-6.7,28.5l-26.4-5.2c1.4-6.2,12.4-51.1,14-82.5l28.9,2.3c-0.8,9-2,18.2-3.7,27.4l-0.1,0.9l21.3,0.1l0.1-41.2l31.4,0.1l-0.1,41.2l40.4,0.1l-0.1,27l-40.4-0.1l0,38.9l49,0.1L813.1,635.9z M901.6,349.1c-2.2,42.2-27,63.1-75.8,63.9c-48.4-0.9-73.6-22.5-75.2-64.1v-83.3c0.9-17.2,8.3-25.6,22.9-25.6c13.5,0.6,20.6,9,21.4,25.6V349c0.8,18.2,13.1,29.9,31.2,30c17.5,0,30.3-12.3,31.2-29.9v-83.3c0.6-16.2,8.2-25,22-25.4c14,0.5,21.5,9.1,22.3,25.5V349.1z"></path> <path d="M729.1,743.6c0.1,0,2,0,5.1,0c9.6,0,18.2,0,23.4,0c3.1,0,5,0,5,0c4.1,0,7-0.9,9-2.9c2.4-2.3,3.1-6.1,3.1-11.4l0.1-50.2l-57.6-0.1l-0.1,50.2c0,5.3,0.7,9.2,3,11.4C722,742.6,725,743.6,729.1,743.6z"></path> </g> </svg> </a></li> <li><a href="https://www.zhihu.com/people/morvan/activities" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 24 24"> <path d="M5.721 0C2.251 0 0 2.25 0 5.719V18.28C0 21.751 2.252 24 5.721 24h12.56C21.751 24 24 21.75 24 18.281V5.72C24 2.249 21.75 0 18.281 0zm1.964 4.078c-.271.73-.5 1.434-.68 2.11h4.587c.545-.006.445 1.168.445 1.171H9.384a58.104 58.104 0 01-.112 3.797h2.712c.388.023.393 1.251.393 1.266H9.183a9.223 9.223 0 01-.408 2.102l.757-.604c.452.456 1.512 1.712 1.906 2.177.473.681.063 2.081.063 2.081l-2.794-3.382c-.653 2.518-1.845 3.607-1.845 3.607-.523.468-1.58.82-2.64.516 2.218-1.73 3.44-3.917 3.667-6.497H4.491c0-.015.197-1.243.806-1.266h2.71c.024-.32.086-3.254.086-3.797H6.598c-.136.406-.158.447-.268.753-.594 1.095-1.603 1.122-1.907 1.155.906-1.821 1.416-3.6 1.591-4.064.425-1.124 1.671-1.125 1.671-1.125zM13.078 6h6.377v11.33h-2.573l-2.184 1.373-.401-1.373h-1.219zm1.313 1.219v8.86h.623l.263.937 1.455-.938h1.456v-8.86z"></path> </svg> </a></li><li><a href="http://weibo.com/u/5945530751" target="_blank"> <svg class="footer-subscribe-link" viewBox="0 0 32 32"> <path d="M21.938 6.281a6.314 6.314 0 0 0-1.625.125.93.93 0 0 0-.72 1.094.93.93 0 0 0 1.095.719c1.527-.324 3.19.136 4.312 1.375a4.552 4.552 0 0 1 .938 4.437c-.157.485.109 1 .593 1.156.48.157 1-.113 1.157-.593.671-2.09.265-4.473-1.313-6.219a6.395 6.395 0 0 0-4.438-2.094zm-8.282 2.75c-1.676.18-4.015 1.485-6.094 3.563C5.301 14.859 4 17.27 4 19.344c0 3.968 5.082 6.375 10.063 6.375 6.527 0 10.874-3.801 10.874-6.813 0-1.82-1.527-2.855-2.906-3.281-.34-.102-.582-.148-.406-.594.383-.965.445-1.812.031-2.406-.777-1.113-2.933-1.055-5.375-.031 0 0-.758.36-.562-.25.375-1.207.304-2.227-.281-2.813-.415-.414-1.02-.582-1.782-.5zm8.125.5a3.091 3.091 0 0 0-.781.063.827.827 0 0 0-.625.969.781.781 0 0 0 .938.593 1.568 1.568 0 0 1 1.468.469c.375.414.473.973.313 1.469a.794.794 0 0 0 .5 1 .793.793 0 0 0 1-.5 3.102 3.102 0 0 0-.657-3.031 3.1 3.1 0 0 0-2.156-1.032zm-7.187 5.281c3.32.118 5.992 1.782 6.219 4.063.257 2.61-2.747 5.047-6.72 5.438-3.972.39-7.429-1.422-7.687-4.032-.258-2.61 2.778-5.047 6.75-5.437.496-.051.965-.047 1.438-.031zM13.03 16.75c-1.437.137-2.789.969-3.406 2.219-.836 1.699-.035 3.601 1.875 4.218 1.98.637 4.313-.351 5.125-2.187.8-1.793-.2-3.621-2.156-4.125a4.162 4.162 0 0 0-1.438-.125zm.906 2.188a.36.36 0 0 1 .157.03c.242.09.351.356.219.595-.141.238-.446.347-.688.25-.238-.098-.32-.36-.188-.594a.613.613 0 0 1 .5-.282zm-1.843.562c.168.004.347.027.5.094.62.265.816.976.437 1.593-.383.614-1.191.907-1.812.625-.61-.277-.79-.996-.406-1.593.285-.446.78-.727 1.28-.719z"></path> </svg> </a></li> </ul> <br> <br> <p><b>Email:</b> mofanpy@hotmail.com</p> <p>© 2022 mofanpy.com All Rights Reserved <a href="http://beian.miit.gov.cn/" target="_blank">粤ICP备20060366号</a></p> </footer> <script>
  
  var _hmt = _hmt || [];
  (function () {
    let hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?9d4c4973d7eb0cd4876e83fa9b6005c9";
    let s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script> <script async="" src="./OpenAI gym 环境库 _ 莫烦Python_files/js(1)"></script> <script>
  $(document).ready(function () {
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-108653085-2');
  })
</script>  <script type="text/javascript">
  $(document).ready(function () {
    (adsbygoogle = window.adsbygoogle || []).onload = function () {
      try {
        [].forEach.call(document.getElementsByClassName('adsbygoogle'), function () {
          adsbygoogle.push({})
        })
      } catch (a) {
        console.log(a)
      }
    }
  });
</script> <ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done" style="display: none !important;" data-ad-status="unfilled"><div id="aswift_0_host" tabindex="0" title="Advertisement" aria-label="Advertisement" style="border: none; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;border:0;width:undefinedpx;height:undefinedpx;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="./OpenAI gym 环境库 _ 莫烦Python_files/ads(4).html" data-google-container-id="a!1" data-load-complete="true"></iframe></div></ins><deepl-input-controller><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://cofdbpoegempjloogbagkncekinflcnj/build/content.css"><div><div class="dl-input-translation-container svelte-ju4595"><div></div></div></div></template></deepl-input-controller></body><iframe id="google_esf" name="google_esf" src="./OpenAI gym 环境库 _ 莫烦Python_files/zrt_lookup.html" style="display: none;"></iframe></html>